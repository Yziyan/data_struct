
# çº¿æ€§è¡¨


* [**æ–‡ç« åœ°å€**](https://juejin.cn/post/7159955445266776071)

## ä¸€ã€çº¿æ€§ç»“æ„

### ï¼ˆ1ï¼‰çº¿æ€§è¡¨

* çº¿æ€§è¡¨æ˜¯å…·æœ‰ n ä¸ª**ç›¸åŒç±»å‹**å…ƒç´ çš„æœ‰é™åºåˆ— (n >= 0)
* å¸¸è§çš„çº¿æ€§è¡¨
    * æ•°ç»„ã€é“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—ã€å“ˆå¸Œè¡¨ï¼ˆæ•£åˆ—è¡¨ï¼‰
* ç”Ÿæ´»ä¸­ä¹Ÿæœ‰å¾ˆå¤šçº¿æ€§è¡¨

![æ’é˜Ÿå›¾ç‰‡_æ’é˜Ÿç´ æ_æ’é˜Ÿé«˜æ¸…å›¾ç‰‡_æ‘„å›¾ç½‘å›¾ç‰‡ä¸‹è½½](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0d91c4b9bd124e89831e86adbccee963~tplv-k3u1fbpfcp-zoom-1.image)

* ç¬”è€…åœ¨æ­¤ç¯‡æ–‡ç« ä¼šå­¦ä¹ `æ•°ç»„ã€é“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—`ï¼Œ`å“ˆå¸Œè¡¨`è¿˜æ²¡æœ‰å­¦ä¹ 

## äºŒã€åŠ¨æ€æ•°ç»„ï¼ˆDynamicArrayï¼‰



### ï¼ˆ1ï¼‰æ•°ç»„ï¼ˆArrayï¼‰

* æ•°ç»„æ˜¯ä¸€ç§é¡ºåºå­˜å‚¨çš„çº¿æ€§è¡¨ï¼Œæ‰€æœ‰å…ƒç´ çš„å†…å­˜åœ°å€æ˜¯è¿ç»­çš„

![image-20221012201459587](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a2f6d4a75a7148f0ad178c4b1f036606~tplv-k3u1fbpfcp-zoom-1.image)

```java
int [] array = new int[] {1, 2, 3};
```

* æ•°ç»„æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç¼ºç‚¹ã€‚**æ— æ³•åŠ¨æ€ä¿®æ”¹æ•°ç»„çš„å®¹é‡**
* åœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œæœ‰å¤šå°‘ä¸ªå…ƒç´ ï¼Œå°±å·²ç»å®šæ­»äº†
* è€Œæˆ‘ä»¬å¹³æ—¶å¾ˆå¤šåœºæ™¯ï¼Œä¸€å¼€å§‹å¯èƒ½éƒ½ä¸çŸ¥é“éœ€è¦å¤šå°‘ç”³è¯·å¤šå¤§çš„å†…å­˜æ¥å­˜æ”¾æ•°æ®
* åœ¨è¿™ä¸ªèƒŒæ™¯ä¸‹ï¼Œå‡ºç°äº†**åŠ¨æ€æ•°ç»„**
* é‚£ä¹ˆæˆ‘ä»¬ä¸‹é¢ï¼Œä¸€èµ·å®ç°ä¸€ä¸ªåŠ¨æ€æ•°ç»„å§~
* ä¸ç”¨çŠ¹è±«ï¼Œæˆ‘ä»¬åªæ˜¯ä¸ºäº†å­¦ä¹ å¸¸è§çš„æ•°æ®ç»“æ„ï¼Œå¹¶ä¸æ˜¯è¦é€ ä¸€ä¸ªæ²¡æœ‰é‚£ä¹ˆå¥½çš„è½®å­


### ï¼ˆ2ï¼‰åŠ¨æ€æ•°ç»„çš„è®¾è®¡



![image-20221011215043660](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e52edec9f6804dabb8dca652f300dffd~tplv-k3u1fbpfcp-zoom-1.image)

* åŠ¨æ€æ•°ç»„é‡Œï¼Œè‡³å°‘åº”è¯¥è¦ç»´æŠ¤ä¸¤ä¸ªæˆå‘˜å˜é‡
    * ä¸€ä¸ªæ˜¯æ•°ç»„å…ƒç´ çš„æ•°é‡
    * å¦ä¸€åˆ™æ˜¯éœ€è¦ç»´æŠ¤çš„ä¸€ä¸ªæ•°ç»„

```java
public class ArrayList<E> {

    /**
     * æ•°ç»„çš„å…ƒç´ ä¸ªæ•°
     */
    private int size;
    /**
     * æ‰€æœ‰çš„å…ƒç´ 
     */
    private E[] elements;
	
    // é»˜è®¤å®¹é‡
    private static final int DEFAULT_CAPACITY = 10;

    public ArrayList() { this(DEFAULT_CAPACITY); }

    public ArrayList(int capacity) {
        capacity = Math.max(capacity, DEFAULT_CAPACITY);
        elements = (E[]) new Object[capacity];
    }
}
```

* æˆ‘è¿™é‡Œè®¾ç½®ä¸€ä¸ªé»˜è®¤å®¹é‡ä¸º `10`ã€‚å½“ç„¶ï¼Œåœ¨ä½¿ç”¨æ­¤åŠ¨æ€æ•°ç»„æ—¶ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ªå®¹é‡



### ï¼ˆ3ï¼‰æ¥å£è®¾è®¡

```java

    /**
     * è·å–æ•°ç»„å…ƒç´ çš„æ•°é‡
     * @return ï¼šå…ƒç´ æ•°é‡
     */
    int size();

    /**
     * æ•°ç»„æ˜¯å¦ä¸ºç©º
     * @return ï¼šæ˜¯å¦ä¸º null
     */
    boolean isEmpty();

    /**
     * æŸ¥çœ‹æŸå…ƒç´ æ˜¯å¦åœ¨æ•°ç»„ä¸­
     * @param elementï¼šæŸ¥çœ‹å…ƒç´ 
     * @return ï¼šæ˜¯å¦å­˜åœ¨
     */
    boolean contains(E element);

    /**
     * åœ¨æ•°ç»„çš„æœ«å°¾æ·»åŠ å…ƒç´ 
     * @param elementï¼šæ·»åŠ çš„å…ƒç´ 
     */
    void add(E element);

    /**
     * æ ¹æ®ç´¢å¼•è·å–æ•°ç»„å…ƒç´ 
     * @param indexï¼šç´¢å¼•
     * @return ï¼šå¯¹åº”å…ƒç´ 
     */
    E get(int index);

    /**
     * ä¿®æ”¹ç‰¹å®šçš„ä½ç½®çš„å…ƒç´ 
     * @param indexï¼šå¾…æ›¿æ¢çš„ç´¢å¼•
     * @param elementï¼šå¾…æ›¿æ¢çš„å…ƒç´ 
     * @return ï¼šä»¥å‰çš„å…ƒç´ 
     */
    E set(int index, E element);

    /**
     * åœ¨ç‰¹å®šä½ç½®æ·»åŠ æ–°å…ƒç´ 
     * @param indexï¼šå¾…æ·»åŠ ä½ç½®
     * @param elementï¼šå¾…æ·»åŠ çš„å…ƒç´ 
     */
    void add(int index, E element);

    /**
     * åˆ é™¤æŸä¸€ä½ç½®çš„å…ƒç´ 
     * @param indexï¼šå¸¦åˆ é™¤å…ƒç´ ä½ç½®
     * @return ï¼šè¢«åˆ é™¤çš„å…ƒç´ 
     */
    E remove(int index);

    /**
     * åˆ é™¤æŸä¸€å…ƒç´ 
     * @param elementï¼šå¾…åˆ é™¤çš„å…ƒç´ 
     * @return ï¼šè¢«åˆ é™¤çš„å…ƒç´ 
     */
    E remove(E element);

    /**
     * æŸ¥çœ‹æŸå…ƒç´ çš„æ‰€åœ¨çš„æ‰€ç´¢å¼•
     * @param elementï¼šæŸ¥æ‰¾çš„å…ƒç´ 
     * @return ï¼šå¯¹åº”ç´¢å¼•
     */
    int indexOf(E element);

    /**
     * æ¸…ç©ºæ•°ç»„å…ƒç´ 
     */
    void clear();

```

* éƒ½æ˜¯å¢åˆ æ”¹æŸ¥çš„æ¥å£ï¼Œéƒ½å¾ˆå¸¸ç”¨ï¼Œå°±ä¸å¤šè§£é‡Šäº†



### ï¼ˆ4ï¼‰ç®€å•æ¥å£çš„å®ç°

#### â‘  `size()`

```java
    public int size() {
        return size;
    }
```

* ç›´æ¥è¿”å›`æˆå‘˜å˜é‡size`å³å¯

#### â‘¡ `isEmpty()`

```java
   public boolean isEmpty() {
        return size == 0;
    }
```

* å¦‚æœæ•°ç»„å…ƒç´ ä¸ªæ•°ä¸º0ï¼Œä»£è¡¨è¿™ä¸ªæ•°ç»„ä¸ºç©º

#### â‘¢ `get()`

```java
   public E get(int index) {
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("Index:" + index + ", Size:" + size);
        }
        return elements[index];
    }
```

* ä»æˆ‘ä»¬å†…éƒ¨ç»´æŠ¤çš„æ•°ç»„ä¸­ï¼Œå–å‡ºç´¢å¼•ä¸º index çš„å…ƒç´ å³å¯
* ä½†æ˜¯åœ¨å–å…ƒç´ ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦**åˆ¤æ–­ç´¢å¼•æ˜¯å¦è¶Šç•Œ**

#### â‘£ `set()`

```java
    public E set(int index, E element) {
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("Index:" + index + ", Size:" + size);
        }
        E oldElement = elements[index];
        elements[index] = element;
        return oldElement;
    }
```

* è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªç®€å•çš„ä¿®æ”¹æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿéœ€è¦åˆ¤æ–­ç´¢å¼•æ˜¯å¦è¶Šç•Œ
* è€Œä¸”è¿™ç§åˆ¤æ–­ï¼Œåœ¨æ•°ç»„é‡Œæ˜¯å¸¸ç”¨çš„ï¼Œæ‰€ä»¥è¿™ç§é‡å¤çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æŠ½å‡º



#### åˆ¤æ–­ç´¢å¼•æ˜¯å¦è¶Šç•Œ

```java
    /**
     * åˆ¤æ–­ç´¢å¼•æ˜¯å¦è¶Šç•Œ
     * @param indexï¼šç´¢å¼•
     */
    private void checkIndex(int index) {
        if (index < 0 || index >= size) {
            throwBoundMsg(index);
        }
    }

    /**
     * æŠ›å‡ºæ•°ç»„è¶Šç•Œçš„å¼‚å¸¸
     */
    private void throwBoundMsg(int index) {
        throw new IndexOutOfBoundsException("Index:" + index + ", Size:" + size);
    }
```



#### â‘¤ `indexOf()`

```java
	public int indexOf(E element) {
        if (element == null) {
            for (int i = 0; i < size; i++) {
                if (elements[i] == null) return i;
            }
        } else {
            for (int i = 0; i < size; i++) {
                if (element.equals(elements[i])) return i;
            }
        }
        return ELEMENT_NOT_FOUND;
    }
```

* æ•°ç»„é‡Œçš„æŸä¸ªå…ƒç´ ï¼Œå¯èƒ½å­˜æ”¾`null`ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾—åš`null`çš„åˆ¤æ–­
* å¦‚æœæ˜¯æŸ¥æ‰¾çš„å…ƒç´ æ˜¯ `null` ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿”å›ç¬¬ä¸€ä¸ªä¸ºç©ºçš„ç´¢å¼•
* ä¸ä¸ºç©ºçš„æ—¶å€™ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªå°ç»†èŠ‚
    * ä½¿ç”¨ `equals()`æ–¹æ³•ï¼Œè€Œæ²¡æœ‰ç›´æ¥ä½¿ç”¨ `==` ï¼ˆé¢˜å¤–è¯ï¼šequals ä¸ == çš„åŒºåˆ«ï¼Ÿï¼‰
    * ä¸Šé¢åˆ¤æ–­è¿‡ï¼š`element != null`äº†ï¼Œå°†å¾…æŸ¥æ‰¾çš„ element åœ¨å‰ï¼Œå°±ä¸ä¼šæœ‰**ç©ºæŒ‡é’ˆå¼‚å¸¸**äº†



#### â‘¥ `clear()`

```java
    public void clear() {
        for (int i = 0; i < size; i++) {
            elements[i] = null;
        }
        size = 0;
    }
```

* æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå°†å…¶æŒ‡å‘ `null`ï¼Œå›æ”¶å…¶å†…å­˜
* æ•°ç»„çš„å†…å­˜å¯ä»¥ä¸å›æ”¶ï¼Œå› ä¸ºä¹‹åå¯èƒ½è¿˜ä¼šä½¿ç”¨



### ï¼ˆ5ï¼‰æ·»åŠ å…ƒç´ â€”â€”add(E elementï¼‰

```java
// ä¸‹é¢ä¸€èµ·å®ç°
 add(size, element);
```



![image-20221012205701976](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ae9c09a59eb48c4b0e29f6459f50b91~tplv-k3u1fbpfcp-zoom-1.image)



* æˆ‘ä»¬éœ€è¦å¾€æ•°ç»„çš„æœ€åæ·»åŠ å…ƒç´ ï¼Œé‚£ä¹ˆåªéœ€è¦æ‰¾åˆ°æœ«å°¾å…ƒç´ çš„åä¸€å…ƒç´ ç´¢å¼•å³å¯
* å¾ˆå®¹æ˜“å‘ç°è§„å¾‹ï¼Œ`å¾…æ·»åŠ ä½ç½®çš„ç´¢å¼• = size`
* å¹¶ä¸”åœ¨æ·»åŠ å®Œæˆä¹‹åï¼Œéœ€è¦å°† `size + 1`
* æˆ‘ä»¬ç­‰ä¼šå’Œå¦ä¸€ä¸ªæ·»åŠ å…ƒç´ çš„æ–¹æ³•`add(int index, E element)`ä¸€èµ·å®ç°
* ä¹Ÿå°±æ˜¯åœ¨æœ€åä¸€ä¸ªä½ç½®æ·»åŠ å…ƒç´ ï¼Œæ‰€ä»¥æˆ‘ä»¬å…±ç”¨ä¸€ä¸ªå®ç°å³å¯~



### ï¼ˆ6ï¼‰åˆ é™¤å…ƒç´ â€”â€”remove(int index)

* å®ç°ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥æƒ³æƒ³å®ç°çš„æ€è·¯
* æœ‰çš„åŒå­¦å¯èƒ½ä¼šæƒ³ï¼Œè¿™è¿˜ä¸ç®€å•å—ï¼Ÿå¦‚ä¸‹å›¾æ‰€ç¤º
    * è¦åˆ é™¤è°ï¼ŒæŠŠè°æŠ æ‰ä¸å°±å®Œäº†å—ï¼Ÿ
    * å°†åé¢çš„å…ƒç´ æ‹¼æ¥åˆ°è¢«åˆ é™¤çš„å…ƒç´ ä¹‹å‰çš„ä½ç½®

![image-20221012211647988](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0b6068be4104497e93f9cba894f6a2da~tplv-k3u1fbpfcp-zoom-1.image)

* æ€è·¯ç¡®å®å¾ˆæ¸…æ™°ï¼Œå¯æ˜¯ç°å®æ˜¯ï¼Œæˆ‘ä»¬æ²¡åŠæ³•è¿™æ ·ç®¡ç†å†…å­˜ï¼Œæˆ‘ä»¬å¼€å¤´ä¹Ÿè¯´äº†
* æ•°ç»„çš„å†…å­˜æ˜¯è¿ç»­çš„ï¼Œä¸€å¼€å§‹ç”³è¯·å¤šå°‘ç©ºé—´ï¼Œé‚£ä¹ˆè¿™ä¸€æ®µç©ºé—´æ˜¯**è¿ç»­ä¸”å›ºå®š**çš„
* åŠ¨æ€æ•°ç»„çš„å†…éƒ¨ç»´æŠ¤çš„ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ­£ç¡®çš„æ€è·¯

```java
   public E remove(int index) {
        checkIndex(index); // åˆ¤æ–­ç´¢å¼•æ˜¯å¦è¶Šç•Œ
        
        // å…ˆä¿å­˜è¦åˆ é™¤çš„å…ƒç´ 
        E oldEle = elements[index];
        
        // å°†å¾…åˆ é™¤å…ƒç´ åé¢çš„å…ƒç´ ï¼Œä¾æ¬¡å¾€å‰æŒªåŠ¨
        for (int i = index; i < size - 1; i++) {
            elements[i] = elements[i + 1];
        }
        // å°†æœ€åæŒªåŠ¨å®Œæˆåçš„å…ƒç´ æ¸…ç©º
        elements[--size] = null;
        return oldEle;
    }
```

![image-20221012220555615](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d215ea8f68554ee28823b10f0fcd1158~tplv-k3u1fbpfcp-zoom-1.image)

* å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ­£ç¡®çš„æ€è·¯åº”è¯¥æ˜¯ï¼šå°†å¾…åˆ å…ƒç´ ä¹‹åçš„å…ƒç´ ï¼Œä¾æ¬¡æŒªåŠ¨åˆ°å‰é¢
* å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬è¿™é‡Œéœ€è¦æŒªåŠ¨3æ¬¡ï¼Œä¹Ÿå°±æ˜¯ä»å¾…åˆ é™¤çš„ç´¢å¼• 2 åˆ° 5 çš„ä½ç½®
* é€šç”¨ä¸€ç‚¹ä¹Ÿå°±æ˜¯ ä» `index åˆ° size -1` çš„ä½ç½®
* ä½ ä¹Ÿçœ‹åˆ°äº†ï¼Œåœ¨æŒªåŠ¨æ“ä½œå®Œæˆåï¼Œæˆ‘ä»¬æœ€åä¸€ä¸ªå…ƒç´ è¿˜å­˜åœ¨ã€‚ä½ å¯èƒ½ä¼šæƒ³ï¼Œä¸éœ€è¦å¤„ç†è¿™ä¸€ä¸ªä½ç½®çš„å…ƒç´ å—ï¼Ÿ
* æ˜¯çš„ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åšä¸€ä¸ªæ“ä½œï¼Œ å°†æŒªåŠ¨å®Œæˆä¹‹åçš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ¸…ç©ºæ‰
* å³`size--; elements[size] == null;`



### ï¼ˆ7ï¼‰æ·»åŠ å…ƒç´ â€”â€”add(int index, E element)

```JAVA
    public void add(int index, E element) {
        checkIndexForAdd(index); // æ£€æŸ¥ç´¢å¼•
        // ç¡®ä¿éœ€è¦å¤šå°‘å®¹é‡ï¼Œä¸å¤Ÿå°±å»æ‰©å®¹ ã€åœ¨ä¸‹é¢è§£é‡Šã€‘
        ensureCapacity(size + 1);
        // å°†å¾…æ·»åŠ å…ƒç´ åé¢çš„å…ƒç´ ä¾æ¬¡æŒªåŠ¨åˆ°åé¢ï¼Œå°†å¾…æ·»åŠ å…ƒç´ ä½ç½®ç©ºå‡ºæ¥
        for (int i = size; i > index; i--) {
            elements[i] = elements[i - 1];
        }
        // ç©ºå‡ºæ¥åå°±å¯ä»¥æ·»åŠ å…ƒç´ äº†~
        elements[index] = element;
        size++;
    }
```

* æˆ‘ä»¬è¿™ä¸ªæ–¹æ³•ï¼Œæ˜¯æƒ³è¦åœ¨æŸä¸€ä½ç½®æ·»åŠ ä¸€ä¸ªå…ƒç´ 
* å¦‚æœä½ ç†è§£äº†ä¸Šé¢åˆ é™¤çš„æ€è·¯ï¼Œé‚£ä¹ˆï¼Œä½ çœ‹çœ‹è¿™ä¸ªæ–¹æ³•çš„å®ç°ï¼Œæ˜¯ä¸æ˜¯ç”¨äº†åŒæ ·çš„æ€è·¯å‘¢~

![image-20221017183832417](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e1ab3f3a3f04d0c9a38292210ab1a92~tplv-k3u1fbpfcp-zoom-1.image)

* ä½†æ˜¯è¦æ³¨æ„â—
    * ä¸åˆ é™¤ä¸åŒçš„åœ°æ–¹ï¼Œè¿™ä¸ªè¦**å…ˆæŒªåŠ¨å¤§**çš„ã€å¦åˆ™åˆ°æ—¶å€™å¾…æ·»åŠ ä½ç½®ä¹‹åå…ƒç´ çš„å€¼éƒ½æ˜¯åŒä¸€ä¸ªäº†ã€‘
    * è¿˜æœ‰åˆ¤æ–­ç´¢å¼•çš„è¾¹ç•Œï¼Œè¿™é‡Œæ˜¯å¯ä»¥ç­‰äºç´¢å¼•çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥å¾€æœ€åä¸€ä¸ªä½ç½®æ·»åŠ å…ƒç´ 
* æ‰€ä»¥æˆ‘ä»¬å¦å¤–å†™äº†ä¸€ä¸ªåˆ¤æ–­è¾¹ç•Œæ˜¯å¦è¶Šç•Œçš„æ–¹æ³•



#### åˆ¤æ–­ç´¢å¼•æ˜¯å¦è¶Šç•Œ

```java
    private void checkIndexForAdd(int index) {
        if (index < 0 || index > size) { // å¯ä»¥ç­‰äºæ•°ç»„çš„size
            throwBoundMsg(index);
        }
    }
```



### ï¼ˆ8ï¼‰å¦‚ä½•æ‰©å®¹

* æ—¢ç„¶æˆ‘ä»¬æ˜¯ä¸€ä¸ªåŠ¨æ€æ•°ç»„ã€‚é‚£ä¹ˆå½“å®¹é‡ä¸å¤Ÿæ—¶ï¼Œåº”è¯¥è¦å»æ‰©å……æ•°ç»„çš„å®¹é‡
* ä¹Ÿå°±æ˜¯è¦è§£å†³å‡ ä¸ªé—®é¢˜
    * ä½•æ—¶ã€ä½•åœ° æ‰©å®¹
    * æ‰©å……å¤šå°‘å®¹é‡
    * æ€ä¹ˆæ‰©å®¹
* é‚£æˆ‘ä»¬å…ˆå®ç°ä¸€ä¸‹ï¼Œå†ç»§ç»­åˆ†æ

```java
private void ensureCapacity(int capacity) {
        int oldCapacity = elements.length; // æ—§å®¹é‡
        if (oldCapacity >= capacity) return; // å¦‚æœæ—§æ•°ç»„å®¹é‡æ¯”æ‰€éœ€çš„æœ€å°å®¹é‡è¿˜å¤§ï¼Œå°±ä¸éœ€è¦æ‰©å®¹
        // æ‰©å……å®¹é‡ä¸ºåŸæ¥çš„ 1.5 å€ ã€ >> ï¼ˆå³ç§»è¿ç®—ç¬¦æ˜¯ Ã· 2ï¼‰ã€‘
        int newCapacity = oldCapacity + (oldCapacity >> 1);
        E[] newElements = (E[]) new Object[newCapacity]; // ç”³è¯·æ›´å¤§å†…å­˜çš„ä¸€æ®µç©ºé—´
        for (int i = 0; i < size; i++) {
            newElements[i] = elements[i]; // å°†æ—§æ•°ç»„çš„å…ƒç´ æ‹·è´åˆ°æ–°æ•°ç»„
        }
        elements = newElements; // è®©å†…éƒ¨ç»´æŠ¤çš„æ•°ç»„æŒ‡å‘æ–°æ•°ç»„
    }
```

* è¿™å°±æ˜¯æˆ‘ä»¬çš„æ‰©å®¹æ–¹æ³•ï¼ŒåŸç†å…¶å®å¾ˆç®€å•ï¼Œæˆ‘æ¥ç”»ä¸€å¹…å›¾ä½ å°±çŸ¥é“äº†

![image-20221017191629760](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5cb0c4dd660945c9ac6b5a49d49751f8~tplv-k3u1fbpfcp-zoom-1.image)



* å› ä¸ºç”³è¯·çš„å †ç©ºé—´ï¼Œåœ°å€æ˜¯**éšæœºä¸”è¿ç»­**çš„ï¼Œæˆ‘ä»¬æ²¡æ³•ç”³è¯·ä¸€æ®µæ–°ç©ºé—´ï¼Œæ‹¼æ¥æ•°ç»„å°¾éƒ¨
* åªèƒ½ç”³è¯·ä¸€æ®µ**æ›´å¤§çš„ç©ºé—´**ï¼Œå°†æ—§æ•°ç»„çš„å…ƒç´ æŒªåŠ¨åˆ°æ–°ç”³è¯·çš„ç©ºé—´
* è‡³äºä½•æ—¶ä½•åœ°å»æ‰©å®¹çš„è¯ï¼Œä¹Ÿä¸éš¾æƒ³æ¸…æ¥š
    * å°±æ˜¯åœ¨æ·»åŠ å…ƒç´ åœ°æ–¹å»æ‰©å®¹
    * è€Œä¸”æ˜¯å½“æ—§å®¹é‡å°äºæœ€å°å®¹é‡`size + 1`æ—¶ï¼Œæ‰éœ€è¦å»æ‰©å®¹



### ï¼ˆ9ï¼‰ç¼©å®¹â€”â€”trim()

* è¯´å®Œäº†æ‰©å®¹ï¼Œæˆ‘ä»¬é¡ºä¾¿è°ˆè°ˆç¼©å®¹
* è‡³äºä¸ºä»€ä¹ˆè¦ç¼©å®¹ï¼Ÿè‚¯å®šæ˜¯å‰©ä½™å®¹é‡å¤ªå¤šäº†å˜›ï¼Œæƒ³çœç‚¹æœªåˆ©ç”¨çš„ç©ºé—´ã€‚ä¹Ÿæ˜¯ä¸€æ ·çš„å‡ ä¸ªé—®é¢˜
    * ä½•æ—¶ã€ä½•åœ°ç¼©å®¹
    * å®¹é‡ç¼©å‡ä¸ºå¤šå°‘
    * å¦‚ä½•ç¼©å®¹

```java
    private void trim() {
        int oldCapacity = elements.length; // æ—§æ•°ç»„å®¹é‡
        int newCapacity = oldCapacity >> 1; // ç¼©å‡ä¸ºæ—§å®¹é‡çš„ä¸€åŠ
        if (newCapacity <= size || oldCapacity <= DEFAULT_CAPACITY) return;
        E[] newElements = (E[]) new Object[newCapacity]; // æ›´å°çš„ä¸€æ®µç©ºé—´
        for (int i = 0; i < size; i++) {
            newElements[i] = elements[i]; // å°†æ—§æ•°ç»„æ‹·è´åˆ°æ–°æ•°ç»„
        }
        elements = newElements;
    }
```

* å’Œæ‰©å®¹ä¸€æ ·ï¼Œä¹Ÿæ˜¯æ–°ç”³è¯·ä¸€æ®µå†…å­˜ç©ºé—´ã€å°†æ—§æ•°ç»„çš„å…ƒç´ æ‹·è´åˆ°æ–°çš„æ•°ç»„é‡Œå³å¯
* æˆ‘ä»¬è¿™é‡Œæ˜¯å½“å…ƒç´ æ•°é‡å°äºæ•°ç»„å®¹é‡çš„ä¸€åŠçš„æ—¶å€™ï¼Œæ‰è¿›è¡Œç¼©å®¹æ“ä½œã€å½“ç„¶ï¼Œä¸èƒ½æ¯”é»˜è®¤å®¹é‡è¿˜å°ï¼Œè¦ä¸ç„¶ä¸‹æ¬¡ä½¿ç”¨çš„æ—¶å€™æ‰©å®¹ä¹Ÿæ¯”è¾ƒè€—æ—¶ã€‘
* ç¼©å®¹æ“ä½œåº”è¯¥æ˜¯æ”¾åœ¨ `size`å‡å°‘çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯ `clear() å’Œ remove()`æ–¹æ³•éœ€è¦ç¼©å®¹æ“ä½œ
* å¦‚ä½•ç¼©å‡ï¼Œåœ¨ä¸Šé¢äº†ï¼Œå°±ä¸å¤šè¯´äº†~



## ä¸‰ã€é“¾è¡¨ï¼ˆLinked Listï¼‰

### ï¼ˆ1ï¼‰é—®é¢˜å¼•å…¥

* æˆ‘ä»¬ä¸Šé¢è¯´å®Œäº†åŠ¨æ€æ•°ç»„ï¼Œä½ åº”è¯¥èƒ½æ„Ÿè§‰åˆ°ï¼ŒåŠ¨æ€æ•°ç»„ä¹Ÿæœ‰ä¸€äº›ä¸å¤ªå¥½çš„åœ°æ–¹
    * å½“æ‰©å®¹çš„æ—¶å€™ï¼Œä¼šæœ‰å¤§é‡çš„å…ƒç´ æ‹·è´
    * æ‹·è´å®Œæˆåï¼Œæ–°çš„ç©ºé—´ï¼Œ**å¯èƒ½æœ‰å¾ˆå¤šéƒ½æœªä½¿ç”¨**
    * ä¹Ÿå°±æ˜¯è¯´ï¼Œ**åŠ¨æ€æ•°ç»„å¯èƒ½ä¼šé€ æˆç©ºé—´çš„å¤§é‡æµªè´¹**
* é‚£æˆ‘ä»¬èƒ½ä¸èƒ½ç”¨å¤šå°‘ï¼Œå°±ç”³è¯·å¤šå°‘å†…å­˜ç©ºé—´å‘¢ï¼Ÿ
    * è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¼•å…¥äº†é“¾è¡¨ï¼Œå› ä¸ºå®ƒåˆšå¥½å¯ä»¥è¿™æ ·åšã€â—æ³¨ï¼šå¹¶ä¸æ˜¯å–ä»£åŠ¨æ€æ•°ç»„ã€‘



### ï¼ˆ2ï¼‰åŸºæœ¬æ„é€ 

* **é“¾è¡¨æ˜¯ä¸€ç§é“¾å¼å­˜å‚¨çš„çº¿æ€§è¡¨ï¼Œæ‰€æœ‰å…ƒç´ çš„å†…å­˜åœ°å€ä¸ä¸€å®šæ˜¯è¿ç»­çš„**
* å’ŒåŠ¨æ€æ•°ç»„å·®ä¸å¤šï¼Œæœ€å¤§çš„åŒºåˆ«åœ¨äºï¼šæ•°ç»„çš„å†…å­˜ç©ºé—´æ˜¯è¿ç»­çš„ï¼Œéœ€è¦ä¸€æ¬¡æ€§ç”³è¯·
* è€Œé“¾è¡¨çš„**å†…å­˜ç©ºé—´ä¸ä¸€å®šæ˜¯è¿ç»­**çš„ï¼Œå¯ä»¥ç”¨åˆ°æ—¶å†ç”³è¯·

![image-20221018205457431](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/991dbe1ade264d3884d4731c414e9072~tplv-k3u1fbpfcp-zoom-1.image)



### ï¼ˆ3ï¼‰é“¾è¡¨çš„è®¾è®¡

* é“¾è¡¨é‡Œåº”è¯¥ä¹Ÿæœ‰å…ƒç´ çš„ä¸ªæ•° `size`
* è¿˜åº”è¯¥æœ‰ä¸€ä¸ªæŒ‡å‘å¤´èŠ‚ç‚¹ `Node`çš„å¼•ç”¨
* å¹¶ä¸”å†…éƒ¨è¿˜æœ‰ä¸€ä¸ª**èŠ‚ç‚¹ç±»**ã€‚é‡Œé¢è£…ç€å…·ä½“çš„å…ƒç´ `element`å’ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡çš„å¼•ç”¨

![image-20221018205251891](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8d321a2ba97944b896600a3853742a66~tplv-k3u1fbpfcp-zoom-1.image)

```java
public class LinkedList<E> {
    /**
     * é“¾è¡¨å…ƒç´ ä¸ªæ•°
     */
    private int size;
    /**
     * å¤´ç»“ç‚¹
     */
    private Node<E> first;

    /**
     * ç»“ç‚¹ç±»ã€å¤–éƒ¨ä¸å¯è§ã€‘
     */
    private static class Node<E> {
        /**
         * å…·ä½“çš„å…ƒç´ 
         */
        E element;
        /**
         * ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
         */
        Node<E> next;
        public Node(E element, Node<E> next) {
            this.element = element;
            this.next = next;
        }

    }
}
```



### ï¼ˆ4ï¼‰æ¥å£è®¾è®¡

* å…¶å®é“¾è¡¨ä¸­ï¼Œæœ‰å¾ˆå¤šå¯¹å¤–ç•Œæä¾›çš„æ¥å£æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯æœ‰äº›å®ç°ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…±ç”¨ä¸€ä¸ªæ¥å£
* è€Œä¸”é‡Œé¢æœ‰ä¸€äº›ä»£ç æ˜¯å¯ä»¥å’ŒåŠ¨æ€æ•°ç»„å…±ç”¨çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥æ”¹é€ ä¸€ä¸‹ä»£ç ç»“æ„

![image-20221018203218035](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4ed8ea5f7a5c444eb5eb4daeac06cd41~tplv-k3u1fbpfcp-zoom-1.image)



* æˆ‘ä»¬å°†ä¸­é—´åŠ ä¸€å±‚æŠ½è±¡ç±»ï¼Œè®©é“¾è¡¨å’ŒåŠ¨æ€æ•°ç»„ç»§æ‰¿ï¼Œè¿™é‡Œé¢å¯ä»¥æ”¾ä¸€äº›å…¬å…±çš„ä»£ç 
* ç„¶åè®©å…¶æŠ½è±¡çˆ¶ç±»`AbstractList`å®ç° `List`æ¥å£



### ï¼ˆ5ï¼‰æ¸…ç©ºé“¾è¡¨â€”â€”clear()

```java
public void clear() {
    size = 0;
    first = null;
}
```

* å¾ˆç®€å•ï¼Œåªéœ€è¦å°† `size = 0`
* å¹¶ä¸”å°†å¤´ç»“ç‚¹çš„å¼•ç”¨æŒ‡å‘ç©ºå³å¯ï¼Œ`first = null`



### ï¼ˆ6ï¼‰æ·»åŠ å…ƒç´ â€”â€”add(int index, E element)

* æˆ‘ä»¬åœ¨æŸä¸€ç´¢å¼•ä½ç½®æ·»åŠ å…ƒç´ ï¼Œä¸ºäº†æ–¹ä¾¿æ‰¾åˆ°åŸæ¥çš„èŠ‚ç‚¹ï¼Œå¯ä»¥æ‰¾åˆ°ç´¢å¼•ä½ç½®çš„**å‰ä¸€ä¸ªèŠ‚ç‚¹**`prev`ã€å‰é©±èŠ‚ç‚¹ã€‘
* å°†å¾…æ·»åŠ çš„èŠ‚ç‚¹çš„**ä¸‹ä¸€ä¸ªèŠ‚ç‚¹**`next`ã€åç»§èŠ‚ç‚¹ã€‘æŒ‡å‘`prev.next`
* ç„¶åå†å°†**å‰ä¸€ä¸ªèŠ‚ç‚¹**çš„`next`æŒ‡å‘æ–°æ·»åŠ çš„èŠ‚ç‚¹

![image-20221018210939860](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4b34848586a6417a80a3ce0d44bae86e~tplv-k3u1fbpfcp-zoom-1.image)

* é‚£å¦‚æœå¾€ç¬¬ä¸€ä¸ªä½ç½®æ·»åŠ å…ƒç´ å‘¢ï¼Ÿ
* å°±ä¸èƒ½è·å–å‰ä¸€ä¸ªèŠ‚ç‚¹äº†ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜çš„å¯¹è¾¹ç•Œåšç‰¹æ®Šå¤„ç†

![image-20221018212748591](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/581ca6f79d244e6da5cafb8d1ee3561c~tplv-k3u1fbpfcp-zoom-1.image)

* ä¹Ÿæ˜¯ä¸€æ ·çš„æ€è·¯ï¼Œåªä¸è¿‡å°±æ˜¯æ‰¾ä¸åˆ°å‰ä¸€ä¸ªèŠ‚ç‚¹äº†
* ä½†æ˜¯æˆ‘ä»¬å¤©ç„¶å°±æœ‰ä¸€ä¸ª `first`ï¼Œæ˜¯æŒ‡å‘åŸå…ˆçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„
* æ‰€ä»¥æ€è·¯æ˜¯ï¼šå°†æ–°èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘`first`æ‰€æŒ‡å‘çš„èŠ‚ç‚¹
* å†å°†`first`æŒ‡å‘æ–°æ’å…¥çš„èŠ‚ç‚¹å³å¯

```java
    public void add(int index, E element) {
        checkIndexForAdd(index); // åšæŒæ˜¯å¦ç´¢å¼•æ˜¯å¦è¶Šç•Œ
        if (index == 0) { // å¾€å¤´ç»“ç‚¹å¤„æ·»åŠ å…ƒç´ 
            first = new Node<>(element, first);
        } else {
            // æ‹¿åˆ°ç´¢å¼•ä½ç½®çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ ã€node(index)æ–¹æ³•åœ¨ä¸‹é¢è¯´ã€‘
            Node<E> prev = node(index - 1);
            prev.next = new Node<>(element, prev.next);
        }
        size++; // åˆ«å¿˜äº†æ•°é‡è¦++å“Ÿ 
    }
```

> ä¸€èˆ¬å¯¹é“¾è¡¨çš„æ“ä½œï¼Œå¦‚æœindex çš„ç­‰äº 0 ã€sizeã€size - 1ï¼Œè¿™å‡ ä¸ªä½ç½®æ²¡æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆä¸­é—´éƒ¨åˆ†ä¸€èˆ¬ä¸ä¼šå‡ºç°é—®é¢˜

* å¦‚ä¸Šé¢æ‰€è¨€ï¼Œæˆ‘ä»¬å¦‚æœå¾€å°¾ç»“ç‚¹æ·»åŠ å…ƒç´ ï¼Œæ˜¯å¦å¯ä»¥å‘¢ï¼Ÿ
* å¦‚æœä½ è¿™ä¸ªç–‘é—®ï¼Œé‚£ä¹ˆä½ å¯ä»¥è‡ªå·±ç”»å›¾ï¼Œç„¶åç”¨çº¿è¿ä¸€ä¸‹çœ‹çœ‹
* ä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬æ‰€å†™çš„ä»£ç ï¼Œä¹Ÿæ˜¯å¯ä»¥æ»¡è¶³å…¶éœ€æ±‚çš„



#### æ ¹æ®ç´¢å¼•è·å–èŠ‚ç‚¹å¯¹è±¡â€”â€”node(index)

* å¾ˆå¤šåœ°æ–¹ï¼Œå¯èƒ½éƒ½éœ€è¦é€šè¿‡ç´¢å¼•æ¥è·å–èŠ‚ç‚¹å¯¹è±¡
* é‚£ä¹ˆæˆ‘ä»¬å•ç‹¬æä¾›ä¸€ä¸ªç§æœ‰çš„æ–¹æ³•ã€å› ä¸ºèŠ‚ç‚¹å¯¹å¤–éƒ¨ä¸å¯è§ã€‘

```java
    private Node<E> node(int index) {
        checkIndex(index); // æ£€æŸ¥ç´¢å¼•
        Node<E> node = first; // ä»å¤´èŠ‚ç‚¹ä¾æ¬¡å¾€ä¸‹å¯»æ‰¾
        for (int i = 0; i < index; i++) { // å¯»æ‰¾ index æ¬¡å³å¯
            node = node.next; 
        }
        return node;
    }
```

![image-20221018213544104](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a9f26d919908488594ea9c481901ed47~tplv-k3u1fbpfcp-zoom-1.image)

* åªèƒ½æ‹¿ç€è‡ªå·±çš„å¤´ç»“ç‚¹`first`ï¼Œä»å‰å¾€åéå†å–`next`
* ä½†æ˜¯éå†å‡ æ¬¡å‘¢ï¼Ÿä»å›¾ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼Œæƒ³è¦è·å–çš„ç´¢å¼•æ˜¯å¤šå°‘ã€‚é‚£ä¹ˆå°±éå†å‡ æ¬¡
* å†™å®Œäº†è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬æœ‰å¥½å‡ ä¸ªæ–¹æ³•ï¼Œå°±éƒ½èƒ½å®ç°äº†

### ï¼ˆ7ï¼‰è·å–å…ƒç´ â€”â€”get(int index)

```java
public E get(int index) {
    return node(index).element; // è·å–indexå¤„èŠ‚ç‚¹ä¸­çš„å…ƒç´ 
}
```

### ï¼ˆ8ï¼‰ä¿®æ”¹å…ƒç´ â€”â€”set(int index, E element)

```java
public E set(int index, E element) {
    Node<E> node = node(index); // æœªä¿®æ”¹å‰çš„èŠ‚ç‚¹
    E old = node.element;
    node.element = element; // è¦†ç›–åŸå…ˆçš„å€¼å³å¯
    return old;
}
```

### ï¼ˆ9ï¼‰åˆ é™¤å…ƒç´ â€”â€”remove(int index)

```java
    public E remove(int index) {
        checkIndex(index); // æ£€æŸ¥ç´¢å¼•
        Node<E> node = first;
        if (index == 0) { // åˆ é™¤å¤´èŠ‚ç‚¹
            first = first.next; // å°†å¤´ç»“ç‚¹æŒ‡å‘åŸå…ˆå¤´ç»“ç‚¹çš„åç»§èŠ‚ç‚¹
        } else {
            Node<E> prev = node(index - 1); // è·å–å¾…åˆ é™¤ä½ç½®çš„å‰é©±èŠ‚ç‚¹
            node = prev.next; // å–å‡ºåŸå…ˆçš„èŠ‚ç‚¹
            prev.next = node.next; // å°†å‰é©±èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ¢æˆæŒ‡å‘å¾…åˆ é™¤èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹
        }
        size--;
        return node.element;
    }
```

* å¦‚æœä½ äº†è§£äº†ä¸Šé¢æ·»åŠ å…ƒç´ æ—¶çš„æ€è·¯ï¼Œé‚£ä¹ˆåˆ é™¤å…ƒç´ åº”è¯¥éš¾ä¸å€’ä½ 
* å¦‚æœè¿˜ä¸æ¸…æ¥šï¼Œé‚£æˆ‘ä»¬å†æ¥çœ‹å¹…å›¾ï¼š
    * æ€è·¯ä¹Ÿæ˜¯å…ˆæ‰¾åˆ°å¾…åˆ é™¤å…ƒç´ çš„**å‰é©±èŠ‚ç‚¹** `prev`
    * è®©å‰é©±èŠ‚ç‚¹çš„`next`ï¼ŒæŒ‡å‘å¾…åˆ é™¤èŠ‚ç‚¹çš„`next`

![image-20221018220125572](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9b2620339ba47cf8c4ea14d868b4c2f~tplv-k3u1fbpfcp-zoom-1.image)



### ï¼ˆ10ï¼‰æœ‰è™šæ‹Ÿå¤´èŠ‚ç‚¹çš„é“¾è¡¨

* åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œä½ å¯èƒ½å‘ç°äº†ï¼Œé“¾è¡¨çš„**æ·»åŠ ã€åˆ é™¤**æ–¹æ³•
* éƒ½å¯¹`index == 0`ï¼ˆå¯¹å¤´ç»“ç‚¹çš„æ“ä½œï¼‰éƒ½è¿›è¡Œäº†ç‰¹æ®Šå¤„ç†ï¼Œé‚£æˆ‘ä»¬èƒ½ä¸èƒ½åšåˆ°ï¼Œæ‰€æœ‰ä½ç½®ï¼Œéƒ½æ˜¯ä¸€æ ·çš„å¤„ç†å‘¢ï¼Ÿ
* è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°±åœ¨é“¾è¡¨ä¸­å¼•å…¥äº†**è™šæ‹Ÿå¤´ç»“ç‚¹**çš„æ¦‚å¿µ
    * æœ‰æ—¶å€™ä¸ºäº†è®©ä»£ç æ›´åŠ ç²¾ç®€
    * ç»Ÿä¸€æ‰€æœ‰èŠ‚ç‚¹çš„å¤„ç†é€»è¾‘
    * å¯ä»¥åœ¨æœ€å‰é¢å¢åŠ ä¸€ä¸ªä¸å­˜å‚¨æ•°æ®çš„**è™šæ‹Ÿå¤´ç»“ç‚¹**

![image-20221020105151408](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d026ac17ed5640b98ec758039a10a3bb~tplv-k3u1fbpfcp-zoom-1.image)

#### â‘  æ”¹é€ æ„é€ å‡½æ•°

```java
/**
 * å¢åŠ ä¸€ä¸ªè™šæ‹Ÿå¤´ç»“ç‚¹
 */
public LinkedListVNode() {
    first = new Node<>(null, null); // ä¸éœ€è¦å­˜å‚¨å…ƒç´ 
}
```

* åœ¨åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå°±é»˜è®¤æ·»åŠ ä¸€ä¸ªä¸å­˜å‚¨æ•°æ®çš„è™šæ‹Ÿç»“ç‚¹ï¼Œå¹¶ä¸”è®©å¤´ç»“ç‚¹ `first`æŒ‡å‘å®ƒ

#### â‘¡ æ”¹é€ node()æ–¹æ³•

```java
private Node<E> node(int index) {
    checkIndex(index);
    Node<E> node = first.next; // ä»çœŸå®å¤´ç»“ç‚¹å¼€å§‹éå†
    for (int i = 0; i < index; i++) {
        no de = node.next;
    }
    return node;
}
```

* ä¸ä¸Šé¢çš„é“¾è¡¨ä¸€æ¨¡ä¸€æ ·çš„å¤„ç†æ–¹å¼ï¼Œåªä¸è¿‡æ˜¯ä»å¤´ç»“ç‚¹`first`çš„åç»§èŠ‚ç‚¹`next`å¼€å§‹éå†

#### â‘¢ æ”¹é€ remove()ã€add()æ–¹æ³•

```java
public E remove(int index) {
    checkIndex(index); // æ£€æŸ¥ç´¢å¼•
    Node<E> prev = (index == 0) ? first : node(index - 1); // çœ‹çœ‹æ˜¯ä¸æ˜¯åœ¨å¤´ç»“ç‚¹æ“ä½œ
    Node<E> node = prev.next;
    prev.next = node.next;
    size--;
    return node.element;
}

public void add(int index, E element) {
    checkIndexForAdd(index);
    // æ‹¿åˆ°ç´¢å¼•ä½ç½®çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ã€æ²¡æœ‰å°±æ‹¿å¤´ç»“ç‚¹ã€‘
    Node<E> prev = (index == 0) ? first : node(index - 1);
    prev.next = new Node<>(element, prev.next);
    size++;
}
```

* ä¹Ÿæ˜¯åŒä¹‹å‰ä¸€æ ·çš„å¤„ç†æ–¹å¼ï¼Œåªä¸è¿‡ç°åœ¨ä¸éœ€è¦å¯¹ `index == 0`å•ç‹¬å¤„ç†äº†



### ï¼ˆ11ï¼‰åŒå‘é“¾è¡¨

#### â‘  é—®é¢˜å¼•å…¥

* æˆ‘ä»¬ä¸Šé¢æ‰€å­¦ä¹ çš„é“¾è¡¨ï¼Œéƒ½æ˜¯å•å‘é“¾è¡¨ï¼Œæˆ‘ä»¬å»åˆ†æå•å‘é“¾è¡¨çš„å¤æ‚åº¦ä¼šå‘ç°
* å¢åˆ æ”¹æŸ¥çš„å¹³å‡å¤æ‚åº¦éƒ½æ˜¯ `O(n)`ï¼ŒåŠ¨æ€æ•°ç»„çš„æŸ¥è¯¢å’Œä¿®æ”¹å¤æ‚åº¦éƒ½æ˜¯ `O(1)`
* é‚£æˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨é“¾è¡¨å—ï¼Ÿæ¯‹åº¸ç½®ç–‘ï¼Œå½“ç„¶éœ€è¦ã€å†µä¸”Javaå®˜æ–¹çš„é“¾è¡¨ï¼Œä¹Ÿæ˜¯åŒå‘é“¾è¡¨~ã€‘
    * é¦–å…ˆï¼Œä½¿ç”¨é“¾è¡¨ä¸ä¼šæµªè´¹å¾ˆå¤šç©ºé—´
    * å…¶æ¬¡ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ”¹è¿›é“¾è¡¨ï¼Œä½¿å…¶å˜æˆåŒå‘é“¾è¡¨ã€‚**ä»¥æå‡é“¾è¡¨çš„ç»¼åˆæ€§èƒ½**



#### â‘¡ åŸºæœ¬æ„é€ 

```java
public class DoubleLinkedList<E> {
    /**
     * å¤´ç»“ç‚¹
     */
    private Node<E> first;
    /**
     * å°¾ç»“ç‚¹
     */
    private Node<E> last;

    /**
     * å†…éƒ¨çš„èŠ‚ç‚¹ç±»
     */
    private static class Node<E> {
        /**
         * å…·ä½“çš„å…ƒç´ 
         */
        E element;
        /**
         * å‰é©±èŠ‚ç‚¹
         */
        Node<E> prev;
        /**
         * åç»§èŠ‚ç‚¹
         */
        Node<E> next;

        public Node(Node<E> prev, E element, Node<E> next) {
            this.prev = prev;
            this.element = element;
            this.next = next;
        }
    }
}
```

* å¦‚ä¸‹å›¾æ‰€ç¤º
    * é“¾è¡¨å†…éƒ¨è¿˜åº”è¯¥ç»´æŠ¤ä¸€ä¸ªå°¾ç»“ç‚¹`last`
    * æ¯ä¸€ä¸ªèŠ‚ç‚¹å†…éƒ¨ä¹Ÿåº”è¯¥è¿˜æœ‰ä¸€ä¸ªå‰é©±èŠ‚ç‚¹`prev`

![image-20221019220358847](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2627c90704604affad0659d6455384f3~tplv-k3u1fbpfcp-zoom-1.image)

#### â‘¢ ä¼˜åŒ–æŸ¥æ‰¾èŠ‚ç‚¹â€”â€”node(int index)

```java
    private Node<E> node(int index) {
        checkIndex(index);
        Node<E> node;
        // çœ‹çœ‹ç´¢å¼•æ˜¯å¦è¶…è¿‡é“¾è¡¨é•¿åº¦çš„ä¸€åŠ
        if (index < (size >> 1)) { 
            // index < (size / 2) ä»å‰å¾€åæ‰¾
            node = first;
            for (int i = 0; i < index; i++) {
                node = node.next;
            }
        } else {
            // ä»åå¾€å‰æ‰¾
            node = last;
            for (int i = size - 1; i > index; i--) {
                node = node.prev;
            }
        }
        return node;
    }
```

* ä»¥å‰åªèƒ½ä»å¤´ç»“ç‚¹`first`ä¾æ¬¡**å¾€å**æŸ¥æ‰¾èŠ‚ç‚¹
* ç°åœ¨å†…éƒ¨æœ‰å°¾ç»“ç‚¹`last`äº†ï¼Œå°±å¯ä»¥**ä»åå¾€å‰**æ‰¾èŠ‚ç‚¹äº†
* è¿™æ ·ä¸€æ”¹é€ ï¼Œæˆ‘ä»¬æœ€å¤šåªéœ€è¦éå†`size / 2`æ¬¡ï¼Œå³å¯æ‰¾åˆ°å¯¹åº”ç´¢å¼•çš„èŠ‚ç‚¹



#### â‘£ ä¿®æ”¹æ¸…ç©ºå…ƒç´ â€”â€”clear()

```java
    public void clear() {
        size = 0;
        first = null;
        last = null;
    }
```

* æ²¡é”™ï¼Œåœ¨`java`ä¸­å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œ`last`å’Œ`first`å¼•ç”¨ä¸€æ ·ï¼ŒæŒ‡å‘`null`å³å¯



#### â‘¤ ä¼˜åŒ–æ·»åŠ å…ƒç´ â€”â€”add(int inxex, E element)

* æˆ‘ä»¬å›æƒ³ä¸€ä¸‹ï¼Œå•å‘é“¾è¡¨çš„æ·»åŠ æ“ä½œã€‚éœ€è¦æ‹¿åˆ°æ·»åŠ ä½ç½®çš„å‰é©±èŠ‚ç‚¹ `prev = node(index - 1)`ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿æ‹¿åˆ°æ·»åŠ å‰çš„åŸèŠ‚ç‚¹
* è€Œç°åœ¨ï¼Œæ‹¿åˆ°å½“å‰èŠ‚ç‚¹å³å¯ã€‚å› ä¸ºå½“å‰èŠ‚ç‚¹é‡Œï¼Œå°±ä¼šæœ‰å‰é©±èŠ‚ç‚¹çš„å¼•ç”¨

```java
public void add(int index, E element) {
    checkIndexForAdd(index);

    if (index == size) { // index == sizeã€å¾€æœ€åé¢æ·»åŠ å…ƒç´ ã€‘
        Node<E> oldLast = last; // åŸå…ˆçš„å°¾ç»“ç‚¹
        last = new Node<>(oldLast, element, null); // å°†æ–°æ„å»ºçš„èŠ‚ç‚¹èµ‹å€¼ç»™å°¾ç»“ç‚¹
      
        if (oldLast == null) { // index == size == 0ã€ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ ã€‘
            first = last; // å¤´å°¾éƒ½æŒ‡å‘åŒä¸€ä¸ªèŠ‚ç‚¹
        } else {
            oldLast.next = last;
        }
    } else { // å¾€ä»»æ„ä½ç½®
        Node<E> next = node(index); // æ‹¿åˆ°æ·»åŠ å‰çš„èŠ‚ç‚¹ã€ä¹Ÿå°±æ˜¯æ–°æ·»åŠ èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ã€‘
        Node<E> prev = next.prev; // æ‹¿åˆ°å®ƒçš„å‰é©±èŠ‚ç‚¹
        Node<E> node = new Node<>(prev, element, next); // æ„å»ºæ–°çš„èŠ‚ç‚¹
        next.prev = node;

        if (prev == null) {  // index == 0ã€å¾€æœ€å‰é¢æ·»åŠ å…ƒç´ ã€‘
            first = node; // å°†å¤´ç»“ç‚¹æŒ‡å‘æ–°çš„èŠ‚ç‚¹å³å¯
        } else {
            prev.next = node;
        }
    }
    size++;
}
```

* ä¸Šé¢æ˜¯å®Œæ•´å®ç°ï¼Œä¸‹é¢æˆ‘ä¼šå°†å…¶æ‹†åˆ†æˆå¾€å‡ ä¸ªä½ç½®æ·»åŠ èŠ‚ç‚¹ï¼Œè·Ÿç€æˆ‘çš„æ€è·¯ï¼Œä½ ä¹Ÿå¯ä»¥å­¦ä¼šğŸ˜Š~

##### 1ã€å¾€é“¾è¡¨ä¸­é—´ä»»æ„ä½ç½®æ·»åŠ 

![image-20221020093856701](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/53e9c2f411ca4023850253b4726bc99b~tplv-k3u1fbpfcp-zoom-1.image)

* æˆ‘ä»¬æƒ³è¦å°†33æ·»åŠ åˆ°`index == 2`çš„ä½ç½®
* æ€è·¯å¦‚ä¸‹ã€å›¾æ‰€ç¤º
    * å–å‡ºåŸå…ˆ`index == 2`çš„èŠ‚ç‚¹`next`ï¼Œä½œä¸ºå¾…æ·»åŠ èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹
    * æ ¹æ®ä¸Šé¢çš„`next`èŠ‚ç‚¹å–å‡º`prev`èŠ‚ç‚¹ï¼Œä½œä¸ºå¾…æ·»åŠ èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹
    * ç”¨`nextã€prev`èŠ‚ç‚¹æ„å»ºå¾…æ·»åŠ çš„èŠ‚ç‚¹`node`
    * æ„å»ºå®Œæˆåï¼Œå¾…æ·»åŠ èŠ‚ç‚¹éœ€è¦è¿æ¥çš„çº¿å°±æ¥ä¸Šäº†
    * æœ€ååªéœ€è¦å°†`prev`çš„åç»§èŠ‚ç‚¹æŒ‡å‘`node`
    * å°†`next`çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘`node`å³å¯

![image-20221020094526821](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ec2d0e019c4640878c65f29bd2bc45de~tplv-k3u1fbpfcp-zoom-1.image)

```java
Node<E> next = node(index); 
Node<E> prev = next.prev;
Node<E> node = new Node<>(prev, element, next);
next.prev = node;
prev.next = node;
size++;
```

* ä»£ç å¦‚ä¸Šï¼Œä¸éš¾å‘ç°ï¼Œä¸ºä»€ä¹ˆè¦åˆ†æƒ…å†µè®¨è®º
* æ¯”å¦‚è¯´ï¼šæˆ‘ä»¬æƒ³è¦åœ¨ç¬¬ä¸€ä¸ªä½ç½®æ·»åŠ å…ƒç´ ï¼Œé‚£ä¹ˆæ ¹æ®èŠ‚ç‚¹`next`å–å‡ºæ¥çš„èŠ‚ç‚¹`prev`æ˜¯ä¸º`null`çš„
* é‚£ä¹ˆä¸‹é¢åœ¨ç”¨`null`å»æŒ‡å‘èŠ‚ç‚¹`node`ï¼Œè‚¯å®šä¼šå‡ºå¼‚å¸¸å˜›
* é‚£æˆ‘ä»¬å†çœ‹çœ‹ï¼Œå¦‚ä½•æ·»åŠ å…ƒç´ åˆ°`index == 0`çš„ä½ç½®

##### 2ã€å¾€é“¾è¡¨å¤´éƒ¨æ·»åŠ 

![image-20221020100131426](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8a2098c4ba384687abf7ee95ef73a2ad~tplv-k3u1fbpfcp-zoom-1.image)

* æˆ‘ä»¬æƒ³è¦å°†11æ·»åŠ åˆ°`index == 0`çš„ä½ç½®
* æ€è·¯å¦‚ä¸‹ã€å›¾æ‰€ç¤º
    * å–å‡ºåŸå…ˆ`index == 0`çš„èŠ‚ç‚¹`next`ï¼Œä½œä¸ºå¾…æ·»åŠ èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹
    * æ ¹æ®ä¸Šé¢çš„`next`èŠ‚ç‚¹å–å‡º`prev`èŠ‚ç‚¹ï¼Œ**å€¼ä¸º`null`**ï¼Œä½œä¸ºå¾…æ·»åŠ èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹
    * ç”¨`nextã€null`èŠ‚ç‚¹æ„å»ºå¾…æ·»åŠ çš„èŠ‚ç‚¹`node`
    * æ„å»ºå®Œæˆåï¼Œå¾…æ·»åŠ èŠ‚ç‚¹éœ€è¦è¿æ¥çš„çº¿å°±æ¥ä¸Šäº†
    * `prev == null`ï¼Œè¯´æ˜æ˜¯å¾€ç¬¬ä¸€ä¸ªä½ç½®æ·»åŠ ï¼Œå°†**å¤´ç»“ç‚¹**`first`æŒ‡å‘`node`
    * æœ€åå°†`next`çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘`node`å³å¯

![image-20221020100552655](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4a099a035e3f42f8a5206cca37bcc49e~tplv-k3u1fbpfcp-zoom-1.image)

```java
Node<E> next = node(index);
Node<E> prev = next.prev;
Node<E> node = new Node<>(prev, element, next);
next.prev = node;

if (prev == null) {  // index == 0ã€å¾€æœ€å‰é¢æ·»åŠ å…ƒç´ ã€‘
    first = node;
} else {
    prev.next = node;
}
size++;
```

* ä»£ç å¦‚ä¸Šï¼Œè¿™æ—¶ï¼šå¾€ä¸­é—´ã€æœ€å‰é¢æ·»åŠ å…ƒç´ ï¼Œéƒ½è§£å†³äº†
* é‚£ä¹ˆï¼Œæˆ‘ä»¬å†æ¥è®¨è®ºä¸€ä¸‹ï¼Œå‰©ä¸‹ä¸¤ç§æƒ…å†µ

##### 3ã€å¾€é“¾è¡¨å°¾éƒ¨æ·»åŠ 

![image-20221020102524099](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/efaaac8260ec4d67b69d631397dbc758~tplv-k3u1fbpfcp-zoom-1.image)

* æˆ‘ä»¬æƒ³è¦å°†55æ·»åŠ åˆ°`index == size`çš„ä½ç½®
* æ€è·¯å¦‚ä¸‹ã€å›¾æ‰€ç¤º
    * å–å‡ºåŸå…ˆ`index == 4`çš„èŠ‚ç‚¹`oldNode`ï¼Œä½œä¸ºå¾…æ·»åŠ èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹
    * ç”¨`oldNodeã€null`èŠ‚ç‚¹æ„å»ºå¾…æ·»åŠ çš„èŠ‚ç‚¹`node`
    * æ„å»ºå®Œæˆåï¼Œå¾…æ·»åŠ èŠ‚ç‚¹éœ€è¦è¿æ¥çš„çº¿å°±æ¥ä¸Šäº†
    * å°†**å°¾ç»“ç‚¹**`last`æŒ‡å‘`node`
    * æœ€åå°†`oldNode`çš„åç»§èŠ‚ç‚¹æŒ‡å‘`node`å³å¯

![image-20221020102911905](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c32e08f4159a41de8e4950beb153ab4b~tplv-k3u1fbpfcp-zoom-1.image)

```java
if (index == size) { // index == sizeã€å¾€æœ€åé¢æ·»åŠ å…ƒç´ ã€‘
    Node<E> oldLast = last;
    last = new Node<>(oldLast, element, null);
    oldLast.next = last;
} else {
    // ä¸Šé¢ä¸€æ ·çš„ä»£ç ...
}
size++;
```

* ä»£ç å¦‚ä¸Šï¼Œè¿™æ—¶ï¼šä»å°¾éƒ¨æ·»åŠ å…ƒç´ ï¼Œä¹Ÿå¯ä»¥è§£å†³äº†
* é‚£ä¹ˆï¼Œæˆ‘ä»¬æœ€åè®¨è®ºä¸€ç§æœ€ç‰¹æ®Šçš„æƒ…å†µ



##### 4ã€ç¬¬ä¸€æ¬¡æ·»åŠ 

![image-20221020104305325](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3b209ae3269f47bc86ca70fdaee34642~tplv-k3u1fbpfcp-zoom-1.image)

* æˆ‘ä»¬æƒ³è¦å°†11æ·»åŠ åˆ°`index == size == 0`çš„ä½ç½®
* æ€è·¯å¦‚ä¸‹ã€å›¾æ‰€ç¤º
    * ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ æ—¶ï¼Œé“¾è¡¨çš„**å¤´å°¾**èŠ‚ç‚¹éƒ½æ˜¯æŒ‡å‘`null`çš„
    * å–å‡ºåŸå…ˆ`index == 0`çš„èŠ‚ç‚¹`oldNode`ï¼Œ**å€¼ä¸º`null`**ï¼Œä½œä¸ºå¾…æ·»åŠ èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹
    * ç”¨`nullã€null`èŠ‚ç‚¹æ„å»ºå¾…æ·»åŠ çš„èŠ‚ç‚¹`node`
    * æ„å»ºå®Œæˆåï¼Œå¾…æ·»åŠ èŠ‚ç‚¹çš„**å‰é©±å’Œåç»§èŠ‚ç‚¹**éƒ½æŒ‡å‘äº†`null`
    * å°†**å°¾ç»“ç‚¹**`last`æŒ‡å‘`node`
    * å°†**å¤´èŠ‚ç‚¹**`first`ï¼Œä¹ŸæŒ‡å‘`node`
    * æœ€åå‘ç°ï¼Œé“¾è¡¨é‡Œåªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œé“¾è¡¨çš„å¤´å°¾èŠ‚ç‚¹éƒ½æŒ‡å‘è¿™å”¯ä¸€çš„èŠ‚ç‚¹

![image-20221020104809071](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/15c3553da162465588a720d1b208199e~tplv-k3u1fbpfcp-zoom-1.image)

```java
if (index == size) { // index == sizeã€å¾€æœ€åé¢æ·»åŠ å…ƒç´ ã€‘
    Node<E> oldLast = last;
    last = new Node<>(oldLast, element, null);

    if (oldLast == null) { // index == size == 0ã€ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ ã€‘
        first = last;
    } else {
        oldLast.next = last;
    }
} else {
    // ä¸Šé¢ä¸€æ ·çš„ä»£ç ...
}
size++;
```



#### â‘¥ ä¼˜åŒ–åˆ é™¤å…ƒç´ â€”â€”remove(int index)

```java
public E remove(int index) {
    checkIndex(index);
    Node<E> node = node(index); // å–å‡ºåˆ é™¤å‰çš„èŠ‚ç‚¹ A
    Node<E> prev = node.prev; // æ‹¿åˆ°Açš„å‰é©±èŠ‚ç‚¹
    Node<E> next = node.next; // æ‹¿åˆ°Açš„åç»§èŠ‚ç‚¹
    
    if (prev == null) { // index == 0ã€åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ã€‘
        first = next; // å°†å¤´ç»“ç‚¹æŒ‡å‘Açš„åç»§èŠ‚ç‚¹
    } else {
        prev.next = next; // å°†Açš„å‰é©±èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘Açš„åç»§èŠ‚ç‚¹
    }
    
    if (next == null) { // index == size - 1ã€åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ ã€‘
        last = prev; // å°†å°¾ç»“ç‚¹æŒ‡å‘Açš„å‰é©±èŠ‚ç‚¹
    } else {
        next.prev = prev; // å°†Açš„åç»§èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘Açš„å‰é©±èŠ‚ç‚¹
    }
    size--;
    return node.element;
}
```

* åˆšåˆšè¯¦ç»†çš„è®²è§£è¿‡äº†`add()`æ–¹æ³•ï¼Œåˆ é™¤æ–¹æ³•ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†
* æ‹¿åˆ°å¾…åˆ é™¤çš„èŠ‚ç‚¹`node`
* æ ¹æ®`node`è·å–å‰é©±èŠ‚ç‚¹`prev`ï¼Œåç»§èŠ‚ç‚¹`next`
* å°†èŠ‚ç‚¹`prev`çš„åç»§èŠ‚ç‚¹æŒ‡å‘`next`
* å°†èŠ‚ç‚¹`next`çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘`prev`
* å½“ç„¶ï¼Œåˆ«å¿˜äº†`prev == null`ã€åˆ é™¤ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‘å’Œ`next == null`ã€åˆ é™¤æœ€åä¸€ä¸ªèŠ‚ç‚¹ã€‘çš„æƒ…å†µ
* åˆ é™¤å®Œæˆåï¼Œå°†`size - 1`å³å¯ï¼Œæˆ‘è¿™é‡Œå°±ä¸å»ç”»å›¾è§£é‡Šäº†ï¼Œå¯ä»¥å‚ç…§æ·»åŠ èŠ‚ç‚¹çš„æ€è·¯~è‡ªå·±ç”»å›¾è¯•è¯•



### ï¼ˆ12ï¼‰å•å‘å¾ªç¯é“¾è¡¨

#### â‘ åŸºæœ¬æ„é€ 

* åœ¨å•å‘é“¾è¡¨`LinkedList`çš„åŸºç¡€ä¸Šï¼Œå°†å…¶æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹`next`ï¼ŒæŒ‡å‘å¤´ç»“ç‚¹å³å¯
* é‚£æˆ‘ä»¬æ¥æ”¹é€ ä¸€ä¸‹å•å‘é“¾è¡¨`LinkedList`çš„å‡ ä¸ªæ–¹æ³•ï¼Œåº”è¯¥å°±å¯ä»¥äº†

![image-20221020133814652](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/55d8f49c46b84b59ac3699ea0938b8f8~tplv-k3u1fbpfcp-zoom-1.image)



#### â‘¡ æ”¹é€ æ·»åŠ å…ƒç´ â€”â€”add(int index, E element)

```java
    public void add(int index, E element) {
        checkIndexForAdd(index);
        if (index == 0) { // å¾€å¤´èŠ‚ç‚¹æ·»åŠ å…ƒç´ 
            Node<E> newFirst = new Node<>(element, first); // æ„å»ºæ–°çš„èŠ‚ç‚¹
            Node<E> last = (size == 0) ? newFirst :node(size - 1); // è·å–å°¾ç»“ç‚¹
            first = newFirst; // æ”¹å˜å¤´ç»“ç‚¹æŒ‡å‘ã€å¿…é¡»å†ä¸Šé¢è·å–å°¾èŠ‚ç‚¹æ“ä½œä¹‹åè¿›è¡Œã€‘
            last.next = first; // å°†å°¾ç»“ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘å¤´ç»“ç‚¹
        } else {
            // æ‹¿åˆ°ç´¢å¼•ä½ç½®çš„å‰ä¸€ä¸ªèŠ‚ç‚¹
            Node<E> prev = node(index - 1);
            prev.next = new Node<>(element, prev.next);
        }
        size++;
    }
```

* ç›¸æ¯”äºå•å‘é“¾è¡¨ï¼Œå°±æ˜¯åœ¨å¾€ç¬¬ä¸€ä¸ªä½ç½®æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦å°†æœ€åä¸€ä¸ªèŠ‚ç‚¹`last`çš„åç»§èŠ‚ç‚¹`next`
* æŒ‡å‘æ·»åŠ åæ–°çš„å¤´ç»“ç‚¹`first`
* **æ³¨æ„**ï¼šè¦å…ˆè·å–ä»¥å‰çš„å°¾ç»“ç‚¹`last`ï¼Œå†æ”¹å˜å¤´ç»“ç‚¹çš„æŒ‡å‘
* æ€è·¯å¾ˆç®€å•ï¼Œæˆ‘å°±ç”»ä¸€ä¸ªï¼Œç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ æ—¶çš„å›¾

![image-20221020140010781](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/37e11358528c4667aa37fd117685c05e~tplv-k3u1fbpfcp-zoom-1.image)



#### â‘¢ æ”¹é€ åˆ é™¤å…ƒç´ â€”â€”remove(int index)

```java
    public E remove(int index) {
        checkIndex(index);
        Node<E> node = first;
        if (index == 0) { // åˆ é™¤ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
            if (size == 1) { // åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„æƒ…å†µ
                first = null;
            } else {
                Node<E> last = node(size - 1); // è·å–å°¾ç»“ç‚¹
                first = first.next; // å°†å¤´ç»“ç‚¹æŒ‡å‘åŸå¤´ç»“ç‚¹çš„åç»§èŠ‚ç‚¹
                last.next = first; // å°†å°¾ç»“ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘æ–°çš„å¤´èŠ‚ç‚¹
            }
        } else { // åˆ é™¤ä¸­é—´ã€å°¾éƒ¨ ã€æ“ä½œä¸éœ€è¦æ”¹å˜ã€‘
            Node<E> prev = node(index - 1);
            node = prev.next;
            prev.next = node.next;
        }
        size--;
        return node.element;
    }
```

* ç›¸æ¯”äºå•å‘é“¾è¡¨ï¼Œå°±æ˜¯åœ¨å¾€ç¬¬ä¸€ä¸ªä½ç½®åˆ é™¤å…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦å°†æœ€åä¸€ä¸ªèŠ‚ç‚¹`last`çš„åç»§èŠ‚ç‚¹`next`
* æŒ‡å‘åˆ é™¤åçš„å¤´ç»“ç‚¹`first`å³å¯
* **æ³¨æ„**ï¼šè¦å…ˆè·å–ä»¥å‰çš„å°¾ç»“ç‚¹`last`ï¼Œå†æ”¹å˜å¤´ç»“ç‚¹çš„æŒ‡å‘
* ä½†æ˜¯ä¹Ÿæœ‰ç‰¹æ®Šæƒ…å†µï¼Œå½“é“¾è¡¨ä¸­ï¼Œåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™
* ä»…æ”¹å˜å¼•ç”¨ï¼Œä¸åšç‰¹æ®Šå¤„ç†çš„è¯ï¼Œä¼šåˆ ä¸æ‰é‚£ä¸€ä¸ªèŠ‚ç‚¹
* ä½†æ˜¯å½“åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬è¿˜æƒ³è¦åˆ é™¤è¯¥èŠ‚ç‚¹ï¼Œæ˜¯ä¸æ˜¯ç›´æ¥å°†å¤´ç»“ç‚¹`first`æŒ‡å‘`null`å°±è¡Œå•¦~



### ï¼ˆ13ï¼‰åŒå‘å¾ªç¯é“¾è¡¨

#### â‘  åŸºæœ¬æ„é€ 

![image-20221020143732817](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1822acd809c5411a8d5d1b28808916bd~tplv-k3u1fbpfcp-zoom-1.image)

* åŒä¸Šé¢çš„å•å‘å¾ªç¯é“¾è¡¨ä¸€æ ·ï¼Œæˆ‘ä»¬ä»…éœ€è¦å°†åŒå‘é“¾è¡¨`DoubleLinkedList`æ”¹é€ ä¸€ä¸‹å³å¯
    * å°†å°¾ç»“ç‚¹`last`çš„åç»§èŠ‚ç‚¹æŒ‡å‘å¤´ç»“ç‚¹`first`
    * å°†å¤´ç»“ç‚¹`first`çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘å°¾ç»“ç‚¹`last`



#### â‘¡ æ”¹é€ æ·»åŠ å…ƒç´ â€”â€”add(int index, E element)

```java
public void add(int index, E element) {
    checkIndexForAdd(index);

    if (index == size) { // index == sizeã€å¾€æœ€åé¢æ·»åŠ å…ƒç´ ã€‘
        Node<E> oldLast = last;
        last = new Node<>(oldLast, element, first); // æ”¹é€ â‘ 

        if (oldLast == null) { // index == size == 0ã€ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ ã€‘
            first = last;
            last.next = last; // æ”¹é€ â‘¡
            first.prev = first; // æ”¹é€ â‘¢
        } else {
            oldLast.next = last;
            first.prev = last; // æ”¹é€ â‘£
        }
    } else {
        Node<E> next = node(index);
        Node<E> prev = next.prev;
        Node<E> node = new Node<>(prev, element, next);
        next.prev = node;
        prev.next = node; // æ”¹é€ â‘¤
        
        // æ”¹é€ â‘¥
        if (index == 0) {  // index == 0ã€å¾€æœ€å‰é¢æ·»åŠ å…ƒç´ ã€‘
            first = node;
        }
        
    }
    size++;
}
```

* å¤§ä½“æ€è·¯å’Œä¸Šé¢çš„åŒå‘é“¾è¡¨ä¸€è‡´ï¼Œä½†æ˜¯é‡Œé¢åšäº†å‡ å¤„æ”¹é€ 
* æ”¹é€ â‘ ï¼šç°åœ¨å°¾ç»“ç‚¹`last`çš„åç»§èŠ‚ç‚¹ï¼Œå°†å…¶æ”¹ä¸ºå¤´ç»“ç‚¹`first`
* æ”¹é€ â‘¡ â‘¢ï¼šè‹¥æ˜¯ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ ï¼Œè¿˜è¦å°†æ·»åŠ èŠ‚ç‚¹çš„**åç»§ã€å‰é©±èŠ‚ç‚¹**éƒ½æŒ‡å‘è‡ªå·±

![image-20221020150821009](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6b4474d45916488380a22f53a00e28f8~tplv-k3u1fbpfcp-zoom-1.image)

* æ”¹é€ â‘£ï¼šå°†å¤´ç»“ç‚¹`first`çš„å‰é©±èŠ‚ç‚¹ï¼ŒæŒ‡å‘å°¾ç»“ç‚¹`last`
* æ”¹é€ â‘¤ï¼šç°åœ¨ä¸å­˜åœ¨å¤´ç»“ç‚¹`first`çš„å‰é©±èŠ‚ç‚¹ä¸º`null`çš„æƒ…å†µäº†ï¼Œæ‰€ä»¥å¯ä»¥æ‹¿å‡ºæ¥ï¼Œè®©å…¶å¿…é¡»æ‰§è¡Œ
* æ”¹é€ â‘¥ï¼šç°åœ¨`prev`ä¸å¯èƒ½ä¸º`null`ï¼Œå³åˆ¤æ–­æ˜¯å¦æ˜¯å¾€æœ€å‰é¢æ·»åŠ å…ƒç´ ï¼Œå°±å¾—ç”¨å…¶ä»–æ–¹æ³•åˆ¤æ–­äº†

#### â‘¢ æ”¹é€ åˆ é™¤å…ƒç´ â€”â€”remove(int index)

```java
    public E remove(int index) {
        checkIndex(index);
        Node<E> node = first; // æ”¹é€ â‘ 
        if (size == 1) { // æ”¹é€ â‘¡
            first = null;
            last = null;
        } else {
            node = node(index);
            Node<E> prev = node.prev;
            Node<E> next = node.next;
            prev.next = next; // æ”¹é€ â‘¢
            next.prev = prev; // æ”¹é€ â‘£

            // æ”¹é€ â‘¤
            if (node == first) { // index == 0ã€åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ã€‘
                first = next;
            }

            // æ”¹é€ â‘¥
            if (node == last) { // index == size - 1ã€åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ ã€‘
                last = prev;
            }
        }
        size--;
        return node.element;
    }
```

* æ”¹é€ â‘ ï¼šè¯¥æ–¹æ³•æœ€ç»ˆéœ€è¦è¿”å›è¢«åˆ é™¤èŠ‚ç‚¹çš„å…ƒç´ ï¼Œæ‰€ä»¥ï¼Œå°†å…¶æ‹¿å‡ºæ¥ï¼Œé»˜è®¤æŒ‡å‘å¤´ç»“ç‚¹`first`
* æ”¹é€ â‘¡ï¼šå’Œä¸Šé¢å•å‘å¾ªç¯é“¾è¡¨ç±»ä¼¼ï¼Œå¦‚æœä»…æœ‰ä¸€ä¸ªå…ƒç´ ï¼Œä»…ä»…æ˜¯æ”¹å˜æŒ‡å‘ï¼Œä½†æ˜¯èŠ‚ç‚¹åˆ ä¸æ‰ï¼Œæ‰€ä»¥éœ€è¦åšç‰¹æ®Šå¤„ç†
* æ”¹é€  â‘¢ â‘£ï¼šç°åœ¨`prev`å’Œ`next`éƒ½ä¸å­˜åœ¨ä¸º`null`çš„æƒ…å½¢ï¼Œæ‰€ä»¥å°†å…¶æ‹¿å‡ºæ¥å¿…é¡»æ‰§è¡Œ
* æ”¹é€  â‘¤ â‘¥ï¼šåŒä¸Šï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯åˆ é™¤å¤´å°¾èŠ‚ç‚¹ï¼Œå°±ä¸èƒ½ç”¨prevã€nextæ˜¯å¦ä¸ºnulläº†



## å››ã€æ ˆï¼ˆStackï¼‰

* æ ˆæ˜¯ä¸€ç§åªèƒ½åœ¨**å•ç«¯**æ“ä½œçš„ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§è¡¨

### ï¼ˆ1ï¼‰åŸºæœ¬æ„é€ 

* å¾€æ ˆä¸­æ·»åŠ å…ƒç´ çš„æ“ä½œä¸€èˆ¬å«å…¥æ ˆ
* å¾€æ ˆä¸­ç§»é™¤å…ƒç´ çš„æ“ä½œä¸€èˆ¬å«å‡ºæ ˆã€‚è€Œä¸”åªèƒ½ç§»é™¤æ ˆé¡¶å…ƒç´ 
* éµå¾ªåè¿›å…ˆå‡ºçš„åŸåˆ™

![image-20221020190203027](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fffd5cb701a54cce87b25096a9e769b6~tplv-k3u1fbpfcp-zoom-1.image)

### ï¼ˆ2ï¼‰æ¥å£è®¾è®¡

```java
public interface Stack<E> {
    /**
     * è·å–æ ˆä¸­å…ƒç´ çš„æ•°é‡
     * @return ï¼šå…ƒç´ æ•°é‡
     */
    int size();

    /**
     * æ ˆæ˜¯å¦ä¸ºç©º
     * @return ï¼šæ˜¯å¦ä¸º null
     */
    boolean isEmpty();

    /**
     * å…¥æ ˆ
     */
    void push(E element);

    /**
     * å‡ºæ ˆ
     */
    E pop();

    /**
     * è·å–æ ˆé¡¶å…ƒç´ 
     */
    E top();

    /**
     * æ¸…ç©ºæ ˆçš„æ‰€æœ‰å…ƒç´ 
     */
    void clear();
}
```

### ï¼ˆ3ï¼‰å…·ä½“å®ç°

* æˆ‘ä»¬åˆšå†™å®Œäº†åŠ¨æ€æ•°ç»„å’Œé“¾è¡¨ï¼Œåˆšå¥½å¯ä»¥åˆ©ç”¨å®ƒä»¬æ¥å®ç°æ ˆçš„æ–¹æ³•
* è€Œä¸”ä¸ç®¡æ˜¯å‡ºæ ˆã€å…¥æ ˆï¼Œéƒ½æ˜¯åœ¨æ ˆé¡¶æ“ä½œï¼Œä¹Ÿå°±æ˜¯åœ¨çº¿æ€§è¡¨çš„å°¾éƒ¨æ“ä½œ
* é‚£ä¹ˆç”¨åŠ¨æ€æ•°ç»„å’Œç”¨åŒå‘é“¾è¡¨æ¥å®ç°ï¼Œéƒ½æ˜¯å·®ä¸å¤šçš„ã€‚æˆ‘ä»¬è¿™é‡Œå°±ä½¿ç”¨åŠ¨æ€æ•°ç»„`ArrayList`æ¥å®ç°äº†

```java
public class StackArrayImpl<E> implements Stack<E>{

    private final List<E> list = new ArrayList<>();

    @Override
    public int size() {
        return list.size();
    }

    @Override
    public boolean isEmpty() {
        return list.isEmpty();
    }

    @Override
    public void push(E element) {
        list.add(element);
    }

    @Override
    public E pop() {
        return list.remove(list.size() - 1);
    }

    @Override
    public E top() {
        return list.get(list.size() - 1);
    }
    
    @Override
    public void clear() {
        list.clear();
    }
}
```

* æ²¡é”™ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œå·²ç»å†™å®Œäº†~
* æˆ‘ä»¬è¿™é‡Œæ²¡æœ‰ç›´æ¥ç»§æ‰¿ï¼Œå› ä¸ºä¼šå¼•å…¥`List`ä¸­å…¶ä»–çš„æ–¹æ³•
* è€Œæ˜¯ä½¿ç”¨ç»„åˆçš„è®¾è®¡



### ï¼ˆ4ï¼‰æ ˆçš„åº”ç”¨

* æµè§ˆå™¨çš„å‰è¿›å’Œåé€€

![image-20221020193708787](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89adc5d534364cff9a5df97fbb55b9e2~tplv-k3u1fbpfcp-zoom-1.image)

* è¿˜æœ‰å¾ˆå¤šç±»ä¼¼çš„åº”ç”¨ï¼Œæ¯”å¦‚æ­¥éª¤çš„æ’¤é”€å’Œé‡åš...



## äº”ã€é˜Ÿåˆ—ï¼ˆQueueï¼‰

* é˜Ÿåˆ—æ˜¯ä¸€ç§åªèƒ½åœ¨**å¤´å°¾ä¸¤ç«¯**æ“ä½œçš„ç‰¹æ®Šçš„ä¸€ç§çº¿æ€§è¡¨
* å°±å’Œæˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­çš„æ’é˜Ÿå·®ä¸å¤šã€å½“ç„¶ä¸ç®—æ’é˜Ÿçš„æƒ…å†µ~ğŸ¤·â€â™‚ï¸ã€‘



### ï¼ˆ1ï¼‰åŸºæœ¬æ„é€ 

* åªèƒ½ä»**é˜Ÿå°¾rear**æ·»åŠ å…ƒç´ ï¼Œä¸€èˆ¬å«åšå…¥é˜Ÿ`enQueue`
* åªèƒ½ä»**é˜Ÿå¤´front**åˆ é™¤å…ƒç´ ï¼Œä¸€èˆ¬å«åšå‡ºé˜Ÿ`deQueue`
* éµå¾ª**å…ˆè¿›å…ˆå‡º**çš„åŸåˆ™

![image-20221021084724549](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f99f17c5ca79499d83b174d52c61e764~tplv-k3u1fbpfcp-zoom-1.image)



### ï¼ˆ2ï¼‰æ¥å£è®¾è®¡

```java
public interface Queue<E> {
    /**
     * è·å–é˜Ÿåˆ—ä¸­å…ƒç´ çš„æ•°é‡
     * @return ï¼šå…ƒç´ æ•°é‡
     */
    int size();

    /**
     * é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º
     * @return ï¼šæ˜¯å¦ä¸º null
     */
    boolean isEmpty();

    /**
     * å…¥é˜Ÿ
     */
    void enQueue(E element);

    /**
     * å‡ºé˜Ÿ
     */
    E deQueue();

    /**
     * è·å–é˜Ÿå¤´å…ƒç´ 
     */
    E front();

    /**
     * æ¸…ç©ºé˜Ÿåˆ—çš„æ‰€æœ‰å…ƒç´ 
     */
    void clear();
}
```



### ï¼ˆ3ï¼‰å…·ä½“å®ç°

* åŒæ ˆçš„æ€è·¯ä¸€æ ·ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å¤ç”¨ä¹‹å‰å†™çš„é“¾è¡¨å’ŒåŠ¨æ€æ•°ç»„æ¥å®ç°é˜Ÿåˆ—çš„åŠŸèƒ½
* å¹¶ä¸”æˆ‘ä»¬ä¸€ç›´æ˜¯åœ¨å¤´å°¾ä¸¤ç«¯è¿›è¡Œæ“ä½œï¼Œé‚£æˆ‘ä»¬åº”è¯¥ä¼˜å…ˆ`ç»„åˆ`åŒå‘é“¾è¡¨`DoubleLinkedList`

```java
public class QueueLinkedImpl<E> implements Queue<E> {

    private final List<E> list = new DoubleLinkedList<>();

    @Override
    public int size() {
        return list.size();
    }

    @Override
    public boolean isEmpty() {
        return list.isEmpty();
    }

    @Override
    public void enQueue(E element) {
        list.add(element);
    }

    @Override
    public E deQueue() {
        return list.remove(0);
    }

    @Override
    public E front() {
        return list.get(0);
    }

    @Override
    public void clear() {
        list.clear();
    }
}
```

* æ˜¯çš„ï¼Œå·²ç»å®ç°å®Œæˆäº†
* ç”±æ ˆå’Œé˜Ÿåˆ—çš„å®ç°å¯è§ï¼Œæˆ‘ä»¬çš„åŠ¨æ€æ•°ç»„å’Œé“¾è¡¨æœ‰å¤šä¹ˆé‡è¦äº†å§
* ä½ ä¹Ÿå°±çŸ¥é“æˆ‘å‰é¢ä¸ºä»€ä¹ˆè¦èŠ±é‚£ä¹ˆå¤šçš„æ—¶é—´æ¥è°ˆåŠ¨æ€æ•°ç»„å’Œé“¾è¡¨äº†å§~



### ï¼ˆ4ï¼‰ç”¨æ ˆå®ç°é˜Ÿåˆ—

* æˆ‘ä»¬åˆšåˆšç”¨é“¾è¡¨å®ç°äº†æ ˆï¼Œé‚£æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼Œå¯å¦ä½¿ç”¨æ ˆï¼Œæ¥å®ç°é˜Ÿåˆ—å‘¢ï¼Ÿ



```java
public class QueueStackImpl<E> implements Queue<E> {

    /**
     * ä»…ç”¨äº å…¥é˜Ÿ
     */
    private final Stack<E> inStack = new StackArrayImpl<>();
    /**
     * ç”¨äº å‡ºé˜Ÿã€è·å–é˜Ÿå¤´
     */
    private final Stack<E> outStack = new StackArrayImpl<>();

    @Override
    public int size() {
        return inStack.size() + outStack.size();
    }

    @Override
    public boolean isEmpty() {
        return inStack.isEmpty() && outStack.isEmpty();
    }

    @Override
    public void enQueue(E element) {
        inStack.push(element);
    }

    @Override
    public E deQueue() {
        checkOutStack();
        return outStack.pop();
    }

    @Override
    public E front() {
        checkOutStack();
        return outStack.top();
    }

    @Override
    public void clear() {
        inStack.clear();
        outStack.clear();
    }
    
    /**
     * æ£€æŸ¥æ˜¯å¦éœ€è¦å°† inStackä¸­çš„å…ƒç´ å¼¹åˆ° outStackä¸­
     */
    private void checkOutStack() {
        if (outStack.isEmpty()) {
            while (!inStack.isEmpty()) {
                outStack.push(inStack.pop());
            }
        }
    }
}
```

* æˆ‘è¿™é‡Œç”¨çš„ä¹Ÿæ˜¯æˆ‘ä»¬è‡ªå·±å®ç°çš„æ ˆï¼Œæ€è·¯ä¸éš¾
* å‡†å¤‡ä¸¤ä¸ªæ ˆ
    * ä¸€ä¸ªç”¨äºå…¥æ ˆ`inStack`ï¼šä»…ç”¨äº**å…¥é˜Ÿ**æ“ä½œ
    * ä¸€ä¸ªç”¨äºå‡ºæ ˆ`outStack`ï¼šç”¨äº**å‡ºé˜Ÿã€è·å–é˜Ÿå¤´**æ“ä½œ
* `enQueue`å…¥é˜Ÿæ—¶ï¼Œç›´æ¥å°†å…ƒç´ æ·»åŠ åˆ°`inStack`ä¸­
* `deQueue`å‡ºé˜Ÿæ—¶ï¼Œå°†`outStack`ä¸­çš„æ ˆé¡¶å…ƒç´ å¼¹å‡º
    * æŸ¥çœ‹`outStack`ä¸­æ˜¯å¦ä¸ºç©º
    * è‹¥ä¸ºç©ºï¼Œå°†`inStack`ä¸­çš„æ‰€æœ‰å…ƒç´ å¼¹å‡ºåˆ°`outStack`ä¸­åï¼Œå†å¼¹å‡º`outStack`çš„æ ˆé¡¶å…ƒç´ 
    * è‹¥ä¸ä¸ºç©ºï¼Œç›´æ¥å¼¹å‡º

![image-20221022150757596](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2fc9d14d7032456687fe39ba856eec67~tplv-k3u1fbpfcp-zoom-1.image)



### ï¼ˆ5ï¼‰åŒç«¯é˜Ÿåˆ—ï¼ˆDequeï¼‰

* å°±æ˜¯åœ¨æ™®é€šé˜Ÿåˆ—çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†å¯ä»¥ä»å°¾éƒ¨æ“ä½œå…ƒç´ 

#### â‘  æ–°å¢æ¥å£

```java
public interface DeQueue<E> extends Queue<E> {

    /**
     * ä»é˜Ÿå¤´å…¥é˜Ÿ
     * @param elementï¼šå¾…å…¥é˜Ÿçš„å…ƒç´ 
     */
    void enQueueFront(E element);

    /**
     * ä»é˜Ÿå°¾å‡ºé˜Ÿ
     * @return ï¼šå‡ºé˜Ÿçš„å…ƒç´ 
     */
    E deQueueRear();

    /**
     * ä»é˜Ÿå°¾è·å–å…ƒç´ 
     */
    E rear();

}
```

#### â‘¡ å®ç°

```java
    @Override
    public void enQueueFront(E element) {
        list.add(0, element);
    }

    @Override
    public E deQueueRear() {
        return list.remove(list.size() - 1);
    }

    @Override
    public E rear() {
        return list.get(list.size() - 1);
    }
```

* å°±è´´æ–°å¢çš„æ¥å£çš„å®ç°ï¼Œå…¶ä½™çš„å†ä¸Šé¢æœ‰ï¼Œå°±ä¸é‡å¤è´´äº†



### ï¼ˆ6ï¼‰å¾ªç¯é˜Ÿåˆ—ï¼ˆCircle Queueï¼‰

#### â‘  åŸºæœ¬æ„é€ 

* å¾ªç¯é˜Ÿåˆ—çš„åº•å±‚æ˜¯ç”¨æ•°ç»„æ¥å®ç°çš„ï¼šé˜Ÿåˆ—çš„åº•å±‚ä¹Ÿå¯ä»¥ä½¿ç”¨åŠ¨æ€æ•°ç»„æ¥å®ç°ï¼Œè¿™ä¸ªç”¨æ•°ç»„å®ç°å¹¶ä¸”ä¼˜åŒ–åçš„é˜Ÿåˆ—å«åš**å¾ªç¯é˜Ÿåˆ—**

![image-20221022161056443](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b2d65b97f49f487d83d25b20611c5a32~tplv-k3u1fbpfcp-zoom-1.image)

* å¦‚ä¸Šå›¾æ“ä½œæ‰€ç¤º
    * å¾ªç¯é˜Ÿåˆ—é‡Œè¿˜å¾—æœ‰ä¸€ä¸ªé˜Ÿå¤´ç´¢å¼•`front`
    * å¾ªç¯é˜Ÿåˆ—çš„å…³é”®ç‚¹æ˜¯ï¼šå‡ºé˜Ÿæ—¶ï¼Œä¸æŒªåŠ¨å…ƒç´ ï¼Œä»…ä»…æ”¹å˜é˜Ÿå¤´çš„ç´¢å¼•

```java
public class CircleQueue<E> implements Queue<E> {

    /**
     * æŒ‡å‘é˜Ÿå¤´çš„ç´¢å¼•
     */
    private int front;
    /**
     * å†…éƒ¨ç»´æŠ¤çš„æ•°ç»„
     */
    private E[] elements;
	/**
	 * å…ƒç´ ä¸ªæ•°
	 */
    private int size;

    private static final int DEFAULT_CAPACITY = 10;
    public CircleQueue() {
        elements = (E[]) new Object[DEFAULT_CAPACITY];
    }
}
```



#### â‘¡ å…¥é˜Ÿâ€”â€”enQueue(E element)

* æ—¢ç„¶æˆ‘ä»¬å†…éƒ¨ä½¿ç”¨çš„æ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æƒ³è¦å…¥é˜Ÿï¼Œä¹Ÿå°±æ˜¯ä»æ•°ç»„çš„å°¾éƒ¨æ·»åŠ å…ƒç´ ï¼Œé‚£æ˜¯ä¸æ˜¯ç›´æ¥`elements[size] = element;`å‘¢ï¼Ÿ
* é‚£æˆ‘ä»¬æ¥çœ‹è¿™ç§æƒ…å†µ

![image-20221022163427512](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5ad85ea1eae44c4b86a745faa02a1f4f~tplv-k3u1fbpfcp-zoom-1.image)

* ç°åœ¨çš„é˜Ÿå¤´ç´¢å¼•`front = 1, size = 3` ï¼Œæˆ‘ä»¬æƒ³è¦å°† 77 å…¥é˜Ÿï¼ŒæŒ‰ä¸Šé¢çš„æ€è·¯ï¼Œä¹Ÿå°±æ˜¯`elements[3] = 77`ï¼Œæ˜¯ä¸æ˜¯å°±ä¸å¤ªåˆç†äº†ï¼Ÿ
* æ˜¯ä¸æ˜¯è¿˜éœ€è¦åŠ ä¸Šé˜Ÿå¤´ç´¢å¼•å‘¢ï¼š`elements[size + front] = element`
* æ”¾ä¸Šé¢çš„ä¾‹å­æ¥çœ‹ï¼š`elements[3 + 1] = 77`ï¼Œå¥½åƒç¡®å®å¯ä»¥äº†å“~
* é‚£è¿™æ ·å‘¢ï¼Ÿ

![image-20221022163945058](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1f13764a5dfb4016932db9bacce62204~tplv-k3u1fbpfcp-zoom-1.image)

* ç°åœ¨çš„é˜Ÿå¤´ç´¢å¼•`front = 1, size = 4` ï¼Œæˆ‘ä»¬æƒ³è¦å°† 88 å…¥é˜Ÿï¼ŒæŒ‰ä¸Šé¢çš„æ€è·¯ï¼Œä¹Ÿå°±æ˜¯`elements[4 + 1] = 88`ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿä¸å¤ªåˆç†ï¼Ÿ
* æ‰€ä»¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æœ€ç»ˆçš„æ€è·¯
    * ç”¨ `front + size` å†æ¨¡ä¸Š**æ•°ç»„é•¿åº¦**

```java
    public void enQueue(E element) {
        elements[(front + size) % elements.length] = element;
        size++;
    }
```



#### â‘¢ å‡ºé˜Ÿâ€”â€”deQueue()

* ä¸ä¸Šé¢çš„å…¥é˜Ÿæ€è·¯å¾ˆç±»ä¼¼
* ä¸€å¼€å§‹ï¼Œæ¸…ç©ºåŸæ¥çš„é˜Ÿå¤´å…ƒç´ åï¼Œ`front++`å³å¯ï¼Œä½†é˜Ÿå¤´ç´¢å¼•åœ¨æœ€åæ—¶ï¼Œå°±éœ€è¦æ¨¡ä¸Šæ•°ç»„é•¿åº¦äº†

```java
    public E deQueue() {
        E oldElement = elements[front]; // å–å‡ºåŸå…ˆçš„é˜Ÿå¤´å…ƒç´ 
        elements[front] = null; // å°†å…¶æŒ‡å‘null
        front = (front + 1) % elements.length; // å°†é˜Ÿå¤´ç´¢å¼• front + 1 ï¼ˆä½†å¿…é¡»æ˜¯çœŸå®çš„ç´¢å¼•ï¼‰
        size--;
        return oldElement;
    }
```



#### â‘£ åŠ¨æ€æ‰©å®¹

* ä¸æˆ‘ä»¬ä¹‹å‰åŠ¨æ€æ•°ç»„çš„æ‰©å®¹å¾ˆç›¸ä¼¼
* ä½†æ˜¯ä¹‹å‰åŠ¨æ€æ•°ç»„å…ƒç´ æŒªåŠ¨æ—¶ï¼Œæ–°æ•°ç»„å’Œ**æ—§å¾ªç¯æ•°ç»„**çš„ç´¢å¼•æ˜¯ç›¸åŒçš„
* åœ¨è¿™é‡Œï¼Œæ—§çš„**å¾ªç¯æ•°ç»„**çš„ç´¢å¼•ï¼Œå¾—ä»é˜Ÿå¤´å¼€å§‹æŒªåŠ¨ï¼Œä¹Ÿå°±æ˜¯è¦æ‰¾åˆ°å…ƒç´ åœ¨æ•°ç»„ä¸­**çœŸå®çš„ä½ç½®**

```java
    private void ensureCapacity(int capacity) {
        int oldCapacity = elements.length;
        if (oldCapacity >= capacity) return;
        int newCapacity = oldCapacity + (oldCapacity >> 1);
        E[] newElements = (E[]) new Object[newCapacity];
        for (int i = 0; i < size; i++) {
            newElements[i] = elements[(front + i) % oldCapacity]; // ä»é˜Ÿå¤´å…ƒç´ å¼€å§‹æŒªåŠ¨å…ƒç´ åˆ°æ–°æ•°ç»„
        }
        elements = newElements;
        front = 0;
    }
```



#### â‘¤ è·å–å¾ªç¯æ•°ç»„çš„çœŸå®ç´¢å¼•â€”â€”index(int index)

* åˆšåˆšå†™çš„`å…¥é˜Ÿã€å‡ºé˜Ÿã€æ‰©å®¹`ï¼Œè¿˜æœ‰`clear()æ–¹æ³•`ã€‚éƒ½éœ€è¦æ‰¾åˆ°å…ƒç´ **åœ¨å¾ªç¯æ•°ç»„é‡ŒçœŸå®çš„ç´¢å¼•**
* æ–¹ä¾¿è§£é‡Šï¼Œæˆ‘ä»¬å¼•å…¥ä¸¤ä¸ªæ¦‚å¿µ
    * ç‰©ç†ç´¢å¼•ï¼šæ•°ç»„æ„é€ æ—¶çš„ç´¢å¼•ï¼Œå¦‚`arr = [11, 22, 33]`ä¸­ç”¨ç‰©ç†ç´¢å¼•è·å– `22`ï¼Œä¹Ÿå°±æ˜¯`arr[1]`
    * çœŸå®ç´¢å¼•ï¼šå¾ªç¯æ•°ç»„ä¸­å…ƒç´ çš„çœŸå®ç´¢å¼•ï¼Œå¦‚`front = 1, arr = [11, 22, 33]`ä¸­ç”¨çœŸå®ç´¢å¼•è·å–`22`ï¼Œä¹Ÿå°±æ˜¯`arr[2]`

* å¦‚æœæˆ‘ä»¬æ˜¯å¾ªç¯æ•°ç»„ï¼Œéƒ½éœ€è¦å°†ç´¢å¼•å¤„ç†ä¸€ä¸‹ï¼š`çœŸå®ç´¢å¼• = (ç‰©ç†ç´¢å¼• + front) % capacity`ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†å…¶å°è£…ä¸€ä¸‹

```java
    private int index(int index) {
        return (index + front) % elements.length;
    }
```



### ï¼ˆ7ï¼‰å¾ªç¯åŒç«¯é˜Ÿåˆ—

#### â‘  æ–°å¢çš„æ–¹æ³•

```java
public class CircleDeQue<E> implements DeQue<E> {

    private int front;
    private E[] elements;
    
    @Override
    public void enQueueFront(E element) {
        ensureCapacity(size + 1);
        front = index(-1);
        elements[front] = element;
        size++;
    }

    @Override
    public E deQueueRear() {
        int rearIndex = index(size - 1);
        E oldElement = elements[rearIndex];
        elements[rearIndex] = null;
        size--;
        return oldElement;
    }

    @Override
    public E rear() {
        return elements[index(size - 1)];
    }
}
```

* åŒä¸Šé¢çš„åŒç«¯é“¾è¡¨ä¸€æ ·ï¼Œæ–°å¢äº†å‡ ä¸ªæ–¹æ³•`é˜Ÿå°¾è·å–ã€é˜Ÿå¤´å…¥é˜Ÿã€é˜Ÿå°¾å‡ºé˜Ÿ`
    * åŠ å…¥äº†å¾€é˜Ÿå°¾å…¥é˜Ÿçš„æ–¹æ³•ï¼Œé‚£ä½ å¯èƒ½ä¼šæƒ³ï¼Œæˆ‘ä»¬æ˜¯å¦éœ€è¦æ·»åŠ ä¸€ä¸ªæŒ‡å‘é˜Ÿå°¾çš„ç´¢å¼•
    * ä½ çœ‹çœ‹å®ç°ï¼Œå…¶å®ä¸éœ€è¦ï¼Œæœ‰äº†é˜Ÿå¤´ç´¢å¼•`front`ï¼Œæ‰¾é˜Ÿå°¾åªéœ€è¦å°†`front + size -1`å³å¯
* ä¸æ™®é€šçš„åŒç«¯é“¾è¡¨æ¯”èµ·æ¥ï¼Œè¿™é‡Œéœ€è¦å°†æ•°ç»„çš„ç‰©ç†ç´¢å¼•ï¼Œæ˜ å°„æˆå¾ªç¯æ•°ç»„é‡Œå…ƒç´ çœŸæ­£çš„ç´¢å¼•



#### â‘¡ æ”¹é€ æ˜ å°„ç‰©ç†ç´¢å¼•ä¸ºçœŸå®ç´¢å¼•

```java
    private int index(int index) {
        index += front;
        int capacity = elements.length;
        return (index < 0) ? index + capacity : index % capacity;
    }
```



* æˆ‘ä»¬æƒ³è¦ä»é˜Ÿå¤´å…¥é˜Ÿï¼Œä¹Ÿå°±æ˜¯ä»`çœŸå®ç´¢å¼• = 0`çš„å‰é¢æ’å…¥å…ƒç´ 
* æŒ‰ä¸Šé¢ç»Ÿä¸€çš„å®ç°ï¼Œä¹Ÿå°±æ˜¯å¾€`çœŸå®ç´¢å¼• = -1`å¤„æ·»åŠ å…ƒç´ 
* æŒ‰å°è£…ç´¢å¼•çš„æ€è·¯ï¼š`çœŸå®ç´¢å¼• = (front + ç‰©ç†ç´¢å¼•) % capacity`æ¥çœ‹ï¼Œåœ¨å¤§å¤šæ•°ä½ç½®ï¼Œéƒ½æ˜¯å¯ä»¥çš„
* å¯æ˜¯å½“`çœŸå®ç´¢å¼• = 0`çš„æ—¶å€™ï¼Œå¦‚ä¸‹å›¾
    * æŒ‰ç…§ä¹‹å‰çš„å¤„ç†ï¼š`çœŸå®ç´¢å¼• = (0 - 1) % 5 = -1`ï¼Œé‚£å¾€ `çœŸå®ç´¢å¼• = -1`çš„ä½ç½®æ’å…¥å…ƒç´ ï¼Œå°±å¾—åšå¤„ç†äº†

![image-20221023092047444](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/908dc436d7da4874a694ee2ca739b6bf~tplv-k3u1fbpfcp-zoom-1.image)

* æˆ‘ä»¬è§‚å¯Ÿå‘ç°ï¼Œå½“æƒ³è¦è®¿é—®çš„`ç‰©ç†ç´¢å¼•`ä¸ºè´Ÿæ•°çš„æ—¶å€™
    * æˆ‘ä»¬ä»…ä»…éœ€è¦ï¼š`çœŸå®ç´¢å¼• = ç‰©ç†ç´¢å¼• + æ•°ç»„å®¹é‡`å³å¯

#### â‘¢ ä¼˜åŒ–å–æ¨¡è¿ç®—

* æ”¹é€ å®Œäº†å¾ªç¯åŒç«¯é˜Ÿåˆ—åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†å–æ¨¡è¿ç®—ä¼˜åŒ–ä¸€ä¸‹ã€è®¡ç®—æœºå¤„ç† `ä¹˜ é™¤ å–æ¨¡ æµ®ç‚¹æ•°è¿ç®—`æ•ˆç‡æ¯”è¾ƒä½ã€‘

```java
    private int index(int index) {
        index += front;
        int capacity = elements.length;
        // ä¼˜åŒ–å–æ¨¡è¿ç®—ï¼Œä»…é€‚ç”¨äºã€capacity âˆˆ (0, 2 * index]ã€‘
        return (index < capacity) ? index : index - capacity;
    }
```

* æˆ‘ä»¬è¿™é‡Œçš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯ä¼˜åŒ–ï¼š`n % mï¼Œä¸”å½“ m âˆˆ (0, 2n)æ—¶`
    * å½“ `n < m`æ—¶ï¼Œå–æ¨¡çš„ç»“æœç›´æ¥æ˜¯ `n`
    * å½“ `n >= m`æ—¶ï¼Œå–æ¨¡çš„ç»“æœæ˜¯ `n - m`

